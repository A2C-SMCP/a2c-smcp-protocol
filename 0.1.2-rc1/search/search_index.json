{"config":{"lang":["zh"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"A2C-SMCP Protocol","text":"<ul> <li> <p> \u534f\u8bae\u89c4\u8303</p> <p>\u8be6\u7ec6\u7684\u534f\u8bae\u89c4\u8303\u6587\u6863\uff0c\u5305\u62ec\u67b6\u6784\u8bbe\u8ba1\u3001\u4e8b\u4ef6\u5b9a\u4e49\u3001\u6570\u636e\u7ed3\u6784\u7b49</p> <p> \u5f00\u59cb\u9605\u8bfb</p> </li> <li> <p> SDK \u5b9e\u73b0</p> <p>\u5b98\u65b9 SDK \u5b9e\u73b0\u5e93</p> <ul> <li>Python SDK - Release Candidate</li> <li>Rust SDK - \u5f00\u53d1\u4e2d</li> </ul> </li> <li> <p> \u5e38\u89c1\u95ee\u9898</p> <p>\u5173\u4e8e\u534f\u8bae\u8bbe\u8ba1\u51b3\u7b56\u7684\u5e38\u89c1\u95ee\u9898\u89e3\u7b54</p> <p> \u67e5\u770b FAQ</p> </li> </ul>"},{"location":"#a2c-smcp","title":"\u4ec0\u4e48\u662f A2C-SMCP","text":"<p>A2C-SMCP\uff08Agent To Computer SMCP\uff09\u662f\u4e00\u79cd\u8fdc\u7a0b\u5de5\u5177\u8c03\u7528\u534f\u8bae\uff0c\u5b9a\u4e49\u4e86 Agent \u4e0e\u627f\u8f7d\u591a\u8def MCP Server \u7684 Computer \u4e4b\u95f4\u7684\u901a\u4fe1\u673a\u5236\u3002\u8be5\u534f\u8bae\u8fd0\u884c\u5728 Socket.IO \u4e4b\u4e0a\uff0c\u901a\u8fc7\u4e8b\u4ef6\u9a71\u52a8\u7684\u65b9\u5f0f\u7ec4\u7ec7\u6d88\u606f\uff0c\u5e76\u901a\u8fc7\u623f\u95f4\uff08Room/Office\uff09\u673a\u5236\u5b9e\u73b0\u5b89\u5168\u9694\u79bb\u3002</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Agent  \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2192 \u2502  Server \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2192 \u2502Computer \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502                     \u2502                   \u2502\n   \u2502  \u5de5\u5177\u8c03\u7528\u53d1\u8d77\u65b9     \u2502  \u4fe1\u4ee4\u670d\u52a1\u5668        \u2502  MCP \u670d\u52a1\u7ba1\u7406\u8005\n   \u2502                     \u2502  \u8fde\u63a5\u7ba1\u7406          \u2502  \u5de5\u5177\u6267\u884c\u8005\n   \u2502                     \u2502  \u6d88\u606f\u8def\u7531          \u2502\n   \u2502                     \u2502  \u901a\u77e5\u5e7f\u64ad          \u2502\n</code></pre>"},{"location":"#_1","title":"\u6838\u5fc3\u4f18\u52bf","text":"\u7279\u6027 \u8bf4\u660e \u5de5\u5177\u70ed\u7ba1\u7406 \u52a8\u6001\u53d1\u73b0/\u6ce8\u518c\u5de5\u5177\uff0c\u914d\u7f6e\u70ed\u66f4\u65b0 \u5b89\u5168\u9694\u79bb \u57fa\u4e8e\u623f\u95f4\u7684\u6743\u9650\u8fb9\u754c\uff0cAgent-Computer \u7ed1\u5b9a \u7f51\u7edc\u7a7f\u900f Socket.IO \u957f\u8fde\u63a5\uff0c\u514d\u9664\u516c\u7f51 IP \u4f9d\u8d56 \u5f39\u6027\u67b6\u6784 \u591a Computer \u652f\u6301\uff0c\u5206\u5e03\u5f0f\u5de5\u5177\u90e8\u7f72 \u6807\u51c6\u5316\u63a5\u53e3 \u5f3a\u7c7b\u578b\u6570\u636e\u7ed3\u6784\uff0c\u660e\u786e\u7684\u4e8b\u4ef6\u8fb9\u754c"},{"location":"#_2","title":"\u5feb\u901f\u5bfc\u822a","text":"<ul> <li>\u534f\u8bae\u6982\u8ff0 - \u4e86\u89e3\u8bbe\u8ba1\u76ee\u6807\u4e0e\u6838\u5fc3\u6982\u5ff5</li> <li>\u67b6\u6784\u8bbe\u8ba1 - \u6df1\u5165\u7406\u89e3\u4e09\u89d2\u8272\u6a21\u578b</li> <li>\u4e8b\u4ef6\u5b9a\u4e49 - \u5b8c\u6574\u7684\u4e8b\u4ef6\u5217\u8868\u4e0e\u89c4\u8303</li> <li>\u6570\u636e\u7ed3\u6784 - \u8bf7\u6c42/\u54cd\u5e94\u6570\u636e\u7ed3\u6784\u5b9a\u4e49</li> </ul>"},{"location":"#_3","title":"\u7248\u672c\u4fe1\u606f","text":"<p>\u5f53\u524d\u534f\u8bae\u7248\u672c\uff1a0.1.2-rc1</p>"},{"location":"#license","title":"License","text":"<p>MIT License</p>"},{"location":"appendix/faq/","title":"\u5e38\u89c1\u95ee\u9898 (FAQ)","text":""},{"location":"appendix/faq/#_1","title":"\u5de5\u5177\u8c03\u7528\u76f8\u5173","text":""},{"location":"appendix/faq/#q","title":"Q: \u5de5\u5177\u8c03\u7528\u8fd4\u56de \"\u5f53\u524d\u5de5\u5177\u9700\u8981\u8c03\u7528\u524d\u8fdb\u884c\u4e8c\u6b21\u786e\u8ba4\" \u9519\u8bef","text":"<p>\u95ee\u9898\u63cf\u8ff0:</p> <pre><code>{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"\u5f53\u524d\u5de5\u5177\u9700\u8981\u8c03\u7528\u524d\u8fdb\u884c\u4e8c\u6b21\u786e\u8ba4\uff0c\u4f46\u5ba2\u6237\u7aef\u76ee\u524d\u6ca1\u6709\u5b9e\u73b0\u4e8c\u6b21\u786e\u8ba4\u56de\u8c03\u65b9\u6cd5\"\n    }\n  ],\n  \"isError\": true\n}\n</code></pre> <p>\u539f\u56e0: \u88ab\u8c03\u7528\u7684\u5de5\u5177\u5728\u914d\u7f6e\u4e2d\u542f\u7528\u4e86\u4e8c\u6b21\u786e\u8ba4\uff0c\u4f46\u5ba2\u6237\u7aef\u672a\u5b9e\u73b0\u786e\u8ba4\u56de\u8c03\u3002</p> <p>\u89e3\u51b3\u65b9\u6848:</p> <p>\u65b9\u6848 A: \u4e3a\u7279\u5b9a\u5de5\u5177\u5173\u95ed\u4e8c\u6b21\u786e\u8ba4 <pre><code>{\n  \"tool_meta\": {\n    \"\u5de5\u5177\u540d\": {\n      \"auto_apply\": true\n    }\n  }\n}\n</code></pre></p> <p>\u65b9\u6848 B: \u4e3a\u6240\u6709\u5de5\u5177\u5173\u95ed\u4e8c\u6b21\u786e\u8ba4\uff08\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\uff09 <pre><code>{\n  \"default_tool_meta\": {\n    \"auto_apply\": true\n  }\n}\n</code></pre></p>"},{"location":"appendix/faq/#q_1","title":"Q: \u5de5\u5177\u8c03\u7528\u8d85\u65f6","text":"<p>\u53ef\u80fd\u539f\u56e0: - \u5de5\u5177\u6267\u884c\u65f6\u95f4\u8fc7\u957f - Computer \u4e0d\u5728\u7ebf - \u7f51\u7edc\u8fde\u63a5\u95ee\u9898</p> <p>\u89e3\u51b3\u65b9\u6848: 1. \u589e\u52a0 <code>timeout</code> \u53c2\u6570\u503c 2. \u68c0\u67e5 Computer \u662f\u5426\u6b63\u5e38\u8fd0\u884c 3. \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5</p>"},{"location":"appendix/faq/#q_2","title":"Q: \u627e\u4e0d\u5230\u5de5\u5177","text":"<p>\u53ef\u80fd\u539f\u56e0: - MCP Server \u672a\u542f\u52a8 - \u5de5\u5177\u540d\u79f0\u9519\u8bef - \u5de5\u5177\u5728 <code>forbidden_tools</code> \u4e2d</p> <p>\u89e3\u51b3\u65b9\u6848: 1. \u4f7f\u7528 <code>tools</code> \u547d\u4ee4\u67e5\u770b\u53ef\u7528\u5de5\u5177\u5217\u8868 2. \u68c0\u67e5 MCP Server \u72b6\u6001\uff1a<code>status</code> 3. \u68c0\u67e5\u914d\u7f6e\u4e2d\u7684 <code>forbidden_tools</code></p>"},{"location":"appendix/faq/#desktop","title":"Desktop \u76f8\u5173","text":""},{"location":"appendix/faq/#q-mcp-server-window","title":"Q: \u4e00\u4e2a MCP Server \u80fd\u66b4\u9732\u591a\u5c11\u4e2a window:// \u8d44\u6e90\uff1f","text":"<p>\u7b54: \u6ca1\u6709\u9650\u5236\u3002\u4e00\u4e2a MCP Server \u53ef\u4ee5\u66b4\u9732\u591a\u4e2a <code>window://</code> \u8d44\u6e90\uff0c\u901a\u8fc7 <code>window://{host}/{path}</code> \u533a\u5206\u4e0d\u540c\u7a97\u53e3\u3002Computer \u4f1a\u4ece <code>resources/list</code> \u8fd4\u56de\u4e2d\u7b5b\u9009\u6240\u6709 <code>window://</code> \u8d44\u6e90\u3002</p>"},{"location":"appendix/faq/#q-desktop","title":"Q: Desktop \u662f\u5982\u4f55\u7ec4\u88c5\u7684\uff1f","text":"<p>\u7ec4\u88c5\u6d41\u7a0b: 1. \u8de8 MCP Server \u6c47\u603b\u6240\u6709 <code>window://</code> \u8d44\u6e90 2. \u8bfb\u53d6\u6bcf\u4e2a window \u7684\u5185\u5bb9 3. \u6309\u7b56\u7565\u6392\u5e8f/\u88c1\u526a 4. \u6e32\u67d3\u4e3a\u5b57\u7b26\u4e32\u5217\u8868</p> <p>\u6392\u5e8f\u89c4\u5219: - size \u622a\u65ad: <code>desktop_size</code> \u53c2\u6570\u63a7\u5236\u6570\u91cf\u4e0a\u9650 - server \u4f18\u5148\u7ea7: \u6700\u8fd1\u8c03\u7528\u8fc7\u5de5\u5177\u7684 Server \u4f18\u5148 - \u7a97\u53e3\u6392\u5e8f: \u540c\u4e00 server \u5185\u6309 <code>priority</code> \u964d\u5e8f - fullscreen \u89c4\u5219: fullscreen \u7a97\u53e3\u72ec\u5360\u8be5 Server \u7684\u663e\u793a</p>"},{"location":"appendix/faq/#q-desktop_1","title":"Q: \u4e3a\u4ec0\u4e48 Desktop \u8fd4\u56de\u4e3a\u7a7a\uff1f","text":"<p>\u53ef\u80fd\u539f\u56e0: - \u6ca1\u6709 MCP Server \u66b4\u9732 <code>window://</code> \u8d44\u6e90 - <code>desktop_size</code> \u8bbe\u7f6e\u4e3a 0 \u6216\u8d1f\u6570 - MCP Server \u672a\u542f\u52a8</p>"},{"location":"appendix/faq/#_2","title":"\u8fde\u63a5\u76f8\u5173","text":""},{"location":"appendix/faq/#q-socketio","title":"Q: Socket.IO \u8fde\u63a5\u5931\u8d25","text":"<p>\u53ef\u80fd\u539f\u56e0: - Server URL \u9519\u8bef - \u8ba4\u8bc1\u5931\u8d25 - \u7f51\u7edc\u95ee\u9898</p> <p>\u89e3\u51b3\u65b9\u6848: 1. \u68c0\u67e5 Server URL \u662f\u5426\u6b63\u786e 2. \u9a8c\u8bc1 API Key \u7b49\u8ba4\u8bc1\u4fe1\u606f 3. \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u548c\u9632\u706b\u5899</p>"},{"location":"appendix/faq/#q_3","title":"Q: \u52a0\u5165\u623f\u95f4\u5931\u8d25","text":"<p>\u53ef\u80fd\u539f\u56e0: - \u623f\u95f4\u5df2\u6709 Agent\uff08Agent \u72ec\u5360\u89c4\u5219\uff09 - office_id \u683c\u5f0f\u9519\u8bef - \u672a\u8fde\u63a5\u5230 Server</p> <p>\u89e3\u51b3\u65b9\u6848: 1. \u786e\u8ba4\u623f\u95f4\u5185\u6ca1\u6709\u5176\u4ed6 Agent 2. \u68c0\u67e5 office_id \u683c\u5f0f 3. \u5148\u6267\u884c <code>socket connect</code></p>"},{"location":"appendix/faq/#_3","title":"\u914d\u7f6e\u76f8\u5173","text":""},{"location":"appendix/faq/#q-inputxxx","title":"Q: \u5360\u4f4d\u7b26 ${input:xxx} \u672a\u88ab\u66ff\u6362","text":"<p>\u53ef\u80fd\u539f\u56e0: - \u672a\u52a0\u8f7d inputs \u5b9a\u4e49 - input id \u62fc\u5199\u9519\u8bef</p> <p>\u89e3\u51b3\u65b9\u6848: 1. \u4f7f\u7528 <code>inputs load @file.json</code> \u52a0\u8f7d\u5b9a\u4e49 2. \u4f7f\u7528 <code>inputs list</code> \u68c0\u67e5\u5df2\u6709\u5b9a\u4e49 3. \u786e\u8ba4 id \u62fc\u5199\u6b63\u786e</p>"},{"location":"appendix/faq/#q_4","title":"Q: \u5de5\u5177\u540d\u79f0\u51b2\u7a81","text":"<p>\u8bf4\u660e: \u5f53\u591a\u4e2a MCP Server \u6709\u540c\u540d\u5de5\u5177\u65f6\u4f1a\u4ea7\u751f\u51b2\u7a81\u3002</p> <p>\u89e3\u51b3\u65b9\u6848: \u4f7f\u7528\u522b\u540d\u533a\u5206 <pre><code>{\n  \"tool_meta\": {\n    \"read_file\": {\n      \"alias\": \"local_read_file\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"appendix/faq/#_4","title":"\u6027\u80fd\u76f8\u5173","text":""},{"location":"appendix/faq/#q_5","title":"Q: \u5927\u91cf\u8fde\u63a5\u65f6\u6027\u80fd\u95ee\u9898","text":"<p>\u5efa\u8bae: 1. \u4f7f\u7528 Redis \u4f5c\u4e3a Socket.IO \u4f1a\u8bdd\u5b58\u50a8 2. \u914d\u7f6e\u5408\u7406\u7684\u8fde\u63a5\u6570\u9650\u5236 3. \u4f7f\u7528\u8d1f\u8f7d\u5747\u8861</p>"},{"location":"appendix/faq/#q_6","title":"Q: \u5de5\u5177\u6267\u884c\u6162","text":"<p>\u5efa\u8bae: 1. \u68c0\u67e5 MCP Server \u672c\u8eab\u7684\u6027\u80fd 2. \u8003\u8651\u4f7f\u7528\u5f02\u6b65\u5ba2\u6237\u7aef 3. \u5408\u7406\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4</p>"},{"location":"appendix/faq/#_5","title":"\u5f00\u53d1\u76f8\u5173","text":""},{"location":"appendix/faq/#q_7","title":"Q: \u5982\u4f55\u8c03\u8bd5\u5de5\u5177\u8c03\u7528\uff1f","text":"<p>\u4f7f\u7528 CLI \u7684 <code>tc</code> \u547d\u4ee4\uff1a <pre><code>a2c&gt; tc {\"computer\":\"local\",\"agent\":\"debug\",\"req_id\":\"1\",\"tool_name\":\"echo\",\"params\":{\"text\":\"hello\"},\"timeout\":30}\n</code></pre></p>"},{"location":"appendix/faq/#q_8","title":"Q: \u5982\u4f55\u67e5\u770b\u4e8b\u4ef6\u6d41\uff1f","text":"<p>\u542f\u7528\u8be6\u7ec6\u65e5\u5fd7\uff1a <pre><code>import logging\nlogging.basicConfig(level=logging.DEBUG)\n</code></pre></p>"},{"location":"appendix/faq/#q_9","title":"Q: \u540c\u6b65\u5ba2\u6237\u7aef\u8fd8\u662f\u5f02\u6b65\u5ba2\u6237\u7aef\uff1f","text":"<ul> <li>\u5f02\u6b65\u5ba2\u6237\u7aef: FastAPI\u3001Sanic \u7b49\u5f02\u6b65\u6846\u67b6</li> <li>\u540c\u6b65\u5ba2\u6237\u7aef: Flask\u3001Django \u7b49\u540c\u6b65\u6846\u67b6</li> </ul>"},{"location":"appendix/faq/#_6","title":"\u5176\u4ed6","text":"<p>\u5982\u6709\u5176\u4ed6\u95ee\u9898\uff0c\u8bf7\u901a\u8fc7 Issue \u53cd\u9988\uff0c\u5efa\u8bae\u9644\u5e26\uff1a - \u4f7f\u7528\u573a\u666f\u63cf\u8ff0 - \u6700\u5c0f\u590d\u73b0\u914d\u7f6e - \u65e5\u5fd7\u7247\u6bb5 - \u76f8\u5173\u6d4b\u8bd5\u7528\u4f8b</p>"},{"location":"appendix/faq/#_7","title":"\u53c2\u8003","text":"<ul> <li>\u4e8b\u4ef6\u5b9a\u4e49</li> <li>\u6570\u636e\u7ed3\u6784</li> <li>\u9519\u8bef\u5904\u7406</li> </ul>"},{"location":"specification/","title":"A2C-SMCP \u534f\u8bae\u6982\u8ff0","text":"<p>\u7248\u672c: 0.1.2-rc1 \u72b6\u6001: Release Candidate \u6700\u540e\u66f4\u65b0: 2026-01</p>"},{"location":"specification/#a2c-smcp_1","title":"\u4ec0\u4e48\u662f A2C-SMCP","text":"<p>A2C-SMCP\uff08Agent To Computer SMCP\uff09\u662f\u4e00\u79cd\u8fdc\u7a0b\u5de5\u5177\u8c03\u7528\u534f\u8bae\uff0c\u5b9a\u4e49\u4e86 Agent \u4e0e\u627f\u8f7d\u591a\u8def MCP Server \u7684 Computer \u4e4b\u95f4\u7684\u901a\u4fe1\u673a\u5236\u3002\u8be5\u534f\u8bae\u8fd0\u884c\u5728 Socket.IO \u4e4b\u4e0a\uff0c\u901a\u8fc7\u4e8b\u4ef6\u9a71\u52a8\u7684\u65b9\u5f0f\u7ec4\u7ec7\u6d88\u606f\uff0c\u5e76\u901a\u8fc7\u623f\u95f4\uff08Room/Office\uff09\u673a\u5236\u5b9e\u73b0\u5b89\u5168\u9694\u79bb\u3002</p>"},{"location":"specification/#_1","title":"\u8bbe\u8ba1\u76ee\u6807","text":"<p>A2C-SMCP \u65e8\u5728\u89e3\u51b3\u4f20\u7edf MCP \u534f\u8bae\u5728\u590d\u6742 Agent \u7cfb\u7edf\u4e2d\u7684\u4ee5\u4e0b\u5173\u952e\u95ee\u9898\uff1a</p>"},{"location":"specification/#1-mcp","title":"1. \u591a MCP \u670d\u52a1\u7ba1\u7406\u95ee\u9898","text":"<p>\u5728\u4f01\u4e1a\u7ea7 AI \u5e94\u7528\u4e2d\uff0c\u4e00\u4e2a Agent \u901a\u5e38\u9700\u8981\u534f\u8c03\u591a\u4e2a MCP \u670d\u52a1\uff1a</p> <pre><code>\u4f20\u7edf\u67b6\u6784\uff08\u75db\u70b9\uff09\uff1a\nAgent \u2500\u252c\u2500\u2192 Excel MCP\n       \u251c\u2500\u2192 \u5408\u540c\u751f\u6210 MCP\n       \u251c\u2500\u2192 ERP \u63a5\u53e3 MCP\n       \u2514\u2500\u2192 \u722c\u866b\u5de5\u5177 MCP\n\n\u95ee\u9898\uff1a\n\u2022 Agent \u9700\u5355\u72ec\u7ef4\u62a4\u6bcf\u4e2a MCP \u7684\u751f\u547d\u5468\u671f\n\u2022 \u4efb\u4e00 MCP \u5d29\u6e83\u5bfc\u81f4\u6574\u4f53\u6d41\u7a0b\u5931\u8d25\n\u2022 \u7a7a\u95f2 MCP \u6301\u7eed\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\n</code></pre> <p>A2C-SMCP \u901a\u8fc7\u5f15\u5165 Computer \u62bd\u8c61\u5c42\u89e3\u51b3\u6b64\u95ee\u9898\uff1a</p> <pre><code>SMCP \u67b6\u6784\uff08\u89e3\u51b3\u65b9\u6848\uff09\uff1a\nAgent \u2500\u2500\u2192 Computer \u2500\u252c\u2500\u2192 Excel MCP\n                    \u251c\u2500\u2192 \u5408\u540c\u751f\u6210 MCP\n                    \u251c\u2500\u2192 ERP \u63a5\u53e3 MCP\n                    \u2514\u2500\u2192 \u722c\u866b\u5de5\u5177 MCP\n\n\u4f18\u52bf\uff1a\n\u2022 \u6545\u969c\u9694\u79bb\uff1a\u5355\u4e2a MCP \u5d29\u6e83\u4e0d\u5f71\u54cd Computer \u6574\u4f53\n\u2022 \u70ed\u63d2\u62d4\uff1a\u52a8\u6001\u589e\u5220\u5de5\u5177\u65e0\u9700\u91cd\u542f Agent\n\u2022 \u7edf\u4e00\u76d1\u62a4\uff1aComputer \u5185\u90e8\u5b9e\u65bd\u670d\u52a1\u5065\u5eb7\u76d1\u6d4b\n</code></pre>"},{"location":"specification/#2","title":"2. \u5de5\u5177\u6743\u9650\u4e0e\u5b89\u5168\u6311\u6218","text":"\u5b89\u5168\u95ee\u9898 \u4f20\u7edf MCP \u7f3a\u9677 SMCP \u89e3\u51b3\u65b9\u6848 \u786c\u7f16\u7801 Token Token \u6cc4\u9732\u98ce\u9669 \u96f6\u51ed\u8bc1\u4f20\u64ad\uff1a\u654f\u611f Token \u4ec5\u5b58\u5728\u672c\u5730 Computer \u516c\u7f51\u66b4\u9732\u7aef\u53e3 \u88ab\u653b\u51fb\u98ce\u9669 \u65e0\u516c\u7f51\u66b4\u9732\uff1aComputer \u901a\u8fc7\u957f\u8fde\u63a5\u4e3b\u52a8\u5bf9\u63a5 \u8bc1\u4e66\u51b2\u7a81 \u7248\u6743\u5ba1\u8ba1\u95ee\u9898 \u8bbe\u5907\u7ed1\u5b9a\uff1a\u8bb8\u53ef\u8bc1\u4e0e\u7279\u5b9a Computer \u786c\u4ef6\u7ed1\u5b9a"},{"location":"specification/#3","title":"3. \u7f51\u7edc\u8fde\u63a5\u4e0e\u7a7f\u900f","text":"<ul> <li>\u901a\u8fc7 Socket.IO \u957f\u8fde\u63a5\u5b9e\u73b0\u5185\u7f51\u7a7f\u900f</li> <li>\u65e0\u9700\u516c\u7f51 IP \u6216\u7aef\u53e3\u6620\u5c04</li> <li>\u652f\u6301 NAT\u3001\u9632\u706b\u5899\u3001\u4ee3\u7406\u7b49\u590d\u6742\u7f51\u7edc\u73af\u5883</li> </ul>"},{"location":"specification/#_2","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"specification/#_3","title":"\u4e09\u89d2\u8272\u6a21\u578b","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Agent  \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2192 \u2502  Server \u2502 \u2190\u2500\u2500\u2500\u2500\u2500\u2192 \u2502Computer \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n   \u2502                     \u2502                   \u2502\n   \u2502  \u5de5\u5177\u8c03\u7528\u53d1\u8d77\u65b9     \u2502  \u4fe1\u4ee4\u670d\u52a1\u5668        \u2502  MCP \u670d\u52a1\u7ba1\u7406\u8005\n   \u2502                     \u2502  \u8fde\u63a5\u7ba1\u7406          \u2502  \u5de5\u5177\u6267\u884c\u8005\n   \u2502                     \u2502  \u6d88\u606f\u8def\u7531          \u2502\n   \u2502                     \u2502  \u901a\u77e5\u5e7f\u64ad          \u2502\n</code></pre> \u89d2\u8272 \u6570\u91cf\u7ea6\u675f \u804c\u8d23 Agent \u6bcf\u4e2a\u623f\u95f4\u6700\u591a 1 \u4e2a \u5de5\u5177\u8c03\u7528\u53d1\u8d77\u65b9\uff0c\u901a\u5e38\u4e3a\u667a\u80fd\u4f53\u3001\u673a\u5668\u4eba Server \u5168\u5c40 1 \u4e2a\uff08\u903b\u8f91\uff09 \u4fe1\u4ee4\u4e2d\u67a2\uff0c\u7ba1\u7406\u8fde\u63a5\u3001\u623f\u95f4\u3001\u8def\u7531\u4e0e\u5e7f\u64ad Computer \u6bcf\u4e2a\u623f\u95f4\u53ef\u591a\u4e2a MCP Server \u5bbf\u4e3b\uff0c\u7edf\u4e00\u7ba1\u7406\u548c\u66b4\u9732\u5de5\u5177"},{"location":"specification/#_4","title":"\u623f\u95f4\u9694\u79bb\u6a21\u578b","text":"<p>\u623f\u95f4\uff08Office\uff09\u662f\u903b\u8f91\u9694\u79bb\u5355\u5143\uff0c\u7528\u4e8e\u7ea6\u675f Agent \u4e0e Computer \u7684\u534f\u4f5c\u8303\u56f4\uff1a</p> <ul> <li>\u6bcf\u4e2a\u623f\u95f4\u901a\u8fc7 <code>office_id</code> \u552f\u4e00\u6807\u8bc6</li> <li>\u4e00\u4e2a\u623f\u95f4\u5185\u81f3\u591a\u5305\u542b 1 \u4e2a Agent \u548c \u591a\u4e2a Computer</li> <li>\u8de8\u623f\u95f4\u8bbf\u95ee\u88ab\u4e25\u683c\u7981\u6b62</li> </ul>"},{"location":"specification/#_5","title":"\u4e8b\u4ef6\u5206\u7c7b","text":"<p>\u6240\u6709\u534f\u8bae\u4e8b\u4ef6\u901a\u8fc7 Socket.IO \u547d\u540d\u7a7a\u95f4 <code>/smcp</code> \u4f20\u8f93\uff0c\u91c7\u7528\u524d\u7f00\u7ea6\u5b9a\uff1a</p> \u524d\u7f00 \u65b9\u5411 \u8bf4\u660e <code>client:</code> Agent \u2192 Computer \u5de5\u5177\u64cd\u4f5c\u7c7b\u4e8b\u4ef6\uff0c\u7531 Server \u8def\u7531\u8f6c\u53d1 <code>server:</code> \u5ba2\u6237\u7aef \u2192 Server \u623f\u95f4\u7ba1\u7406\u3001\u914d\u7f6e\u66f4\u65b0\u7c7b\u4e8b\u4ef6 <code>notify:</code> Server \u2192 \u5e7f\u64ad \u72b6\u6001\u53d8\u66f4\u901a\u77e5\uff0c\u5e7f\u64ad\u7ed9\u623f\u95f4\u5185\u6210\u5458"},{"location":"specification/#_6","title":"\u534f\u8bae\u4f18\u52bf\u603b\u7ed3","text":"<ol> <li>\u5de5\u5177\u70ed\u7ba1\u7406: \u52a8\u6001\u53d1\u73b0/\u6ce8\u518c\u5de5\u5177\uff0c\u914d\u7f6e\u70ed\u66f4\u65b0</li> <li>\u5b89\u5168\u9694\u79bb: \u57fa\u4e8e\u623f\u95f4\u7684\u6743\u9650\u8fb9\u754c\uff0cAgent-Computer \u7ed1\u5b9a</li> <li>\u7f51\u7edc\u7a7f\u900f: Socket.IO \u957f\u8fde\u63a5\uff0c\u514d\u9664\u516c\u7f51 IP \u4f9d\u8d56</li> <li>\u5f39\u6027\u67b6\u6784: \u591a Computer \u652f\u6301\uff0c\u5206\u5e03\u5f0f\u5de5\u5177\u90e8\u7f72</li> <li>\u6807\u51c6\u5316\u63a5\u53e3: \u5f3a\u7c7b\u578b\u6570\u636e\u7ed3\u6784\uff0c\u660e\u786e\u7684\u4e8b\u4ef6\u8fb9\u754c</li> </ol>"},{"location":"specification/#_7","title":"\u6587\u6863\u7ed3\u6784","text":"<ul> <li>\u67b6\u6784\u8bbe\u8ba1 - \u89d2\u8272\u5173\u7cfb\u4e0e\u901a\u4fe1\u6a21\u578b</li> <li>\u4e8b\u4ef6\u5b9a\u4e49 - \u5b8c\u6574\u4e8b\u4ef6\u5217\u8868\u4e0e\u89c4\u8303</li> <li>\u6570\u636e\u7ed3\u6784 - \u8bf7\u6c42/\u54cd\u5e94\u6570\u636e\u7ed3\u6784\u5b9a\u4e49</li> <li>\u623f\u95f4\u6a21\u578b - \u623f\u95f4\u9694\u79bb\u673a\u5236\u8be6\u89e3</li> <li>\u9519\u8bef\u5904\u7406 - \u9519\u8bef\u7801\u4e0e\u54cd\u5e94\u683c\u5f0f</li> <li>\u5b89\u5168\u8003\u8651 - \u5b89\u5168\u6027\u8981\u6c42\u4e0e\u5efa\u8bae</li> </ul>"},{"location":"specification/#mcp","title":"\u4e0e MCP \u7684\u5173\u7cfb","text":"<p>A2C-SMCP \u6784\u5efa\u4e8e MCP \u534f\u8bae\u4e4b\u4e0a\uff1a</p> <ul> <li>MCP Server \u5f00\u53d1\u8005: \u65e0\u9700\u4efb\u4f55\u6539\u52a8\uff0c\u73b0\u6709 MCP Server \u53ef\u76f4\u63a5\u88ab Computer \u7ba1\u7406</li> <li>Agent \u5f00\u53d1\u8005: \u4ec5\u9700\u5b9e\u73b0 SMCP \u534f\u8bae\u63a5\u53e3\uff0c\u65e0\u9700\u5173\u5fc3\u5e95\u5c42 MCP \u7ec6\u8282</li> <li>\u5de5\u5177\u8c03\u7528: Agent \u2192 SMCP \u2192 Computer \u2192 MCP \u2192 \u5de5\u5177</li> </ul> <pre><code>Agent \u89c6\u89d2\uff1a\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  A2C-SMCP                    \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 Agent  \u2502\u2500\u2500\u2500\u2192\u2502 Server \u2502\u2500\u2500\u2500\u2192\u2502  Computer  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                      \u2502\n                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                               \u25bc             \u25bc\n                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502MCP Srv1\u2502    \u2502MCP Srv2\u2502\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/#_8","title":"\u4e0b\u4e00\u6b65","text":"<ul> <li>\u6df1\u5165\u4e86\u89e3\uff1a\u9605\u8bfb \u67b6\u6784\u8bbe\u8ba1 \u548c \u4e8b\u4ef6\u5b9a\u4e49</li> <li>\u5e38\u89c1\u95ee\u9898\uff1a\u67e5\u770b FAQ</li> </ul>"},{"location":"specification/architecture/","title":"A2C-SMCP \u67b6\u6784\u8bbe\u8ba1","text":"<p>\u672c\u6587\u6863\u63cf\u8ff0 A2C-SMCP \u534f\u8bae\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u5305\u62ec\u89d2\u8272\u5173\u7cfb\u3001\u901a\u4fe1\u6a21\u578b\u548c\u6838\u5fc3\u7ec4\u4ef6\u3002</p>"},{"location":"specification/architecture/#_1","title":"\u89d2\u8272\u4e0e\u5173\u7cfb","text":""},{"location":"specification/architecture/#_2","title":"\u4e09\u89d2\u8272\u6a21\u578b","text":"<p>A2C-SMCP \u534f\u8bae\u5b9a\u4e49\u4e86\u4e09\u4e2a\u6838\u5fc3\u89d2\u8272\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        A2C-SMCP \u7cfb\u7edf                         \u2502\n\u2502                                                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502          \u2502       \u2502          \u2502       \u2502                  \u2502 \u2502\n\u2502  \u2502  Agent   \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u25ba\u2502  Server  \u2502\u25c4\u2500\u2500\u2500\u2500\u2500\u25ba\u2502    Computer      \u2502 \u2502\n\u2502  \u2502          \u2502       \u2502          \u2502       \u2502                  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502       \u2502                  \u2502                      \u2502           \u2502\n\u2502       \u2502                  \u2502                      \u2502           \u2502\n\u2502  \u5de5\u5177\u8c03\u7528          \u4fe1\u4ee4\u670d\u52a1\u5668              MCP \u670d\u52a1\u7ba1\u7406      \u2502\n\u2502  \u53d1\u8d77\u65b9            \u8fde\u63a5\u7ba1\u7406                \u5de5\u5177\u6267\u884c          \u2502\n\u2502                    \u6d88\u606f\u8def\u7531                                  \u2502\n\u2502                    \u901a\u77e5\u5e7f\u64ad                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/architecture/#_3","title":"\u89d2\u8272\u804c\u8d23","text":"\u89d2\u8272 \u804c\u8d23 \u6570\u91cf\u7ea6\u675f Agent \u5de5\u5177\u8c03\u7528\u53d1\u8d77\u65b9\uff0c\u901a\u5e38\u4e3a\u667a\u80fd\u4f53\u3001\u673a\u5668\u4eba\u7b49\u4e1a\u52a1\u7cfb\u7edf \u6bcf\u4e2a\u623f\u95f4\u6700\u591a 1 \u4e2a Server \u4fe1\u4ee4\u4e2d\u67a2\uff0c\u8d1f\u8d23\u8fde\u63a5\u7ba1\u7406\u3001\u623f\u95f4\u7ba1\u7406\u3001\u6d88\u606f\u8def\u7531\u548c\u901a\u77e5\u5e7f\u64ad \u5168\u5c40 1 \u4e2a\uff08\u903b\u8f91\uff09 Computer MCP Server \u5bbf\u4e3b\uff0c\u7edf\u4e00\u7ba1\u7406\u591a\u4e2a MCP \u670d\u52a1\u5e76\u5bf9\u5916\u66b4\u9732\u5de5\u5177 \u6bcf\u4e2a\u623f\u95f4\u53ef\u591a\u4e2a"},{"location":"specification/architecture/#_4","title":"\u89d2\u8272\u5173\u7cfb\u7ea6\u675f","text":"<ol> <li>Agent \u72ec\u5360\u6027: \u4e00\u4e2a\u623f\u95f4\u5185\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a Agent</li> <li>Computer \u7ed1\u5b9a\u6027: \u4e00\u4e2a Computer \u5728\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u623f\u95f4</li> <li>Server \u4e2d\u5fc3\u6027: \u6240\u6709 Agent \u548c Computer \u4e4b\u95f4\u7684\u901a\u4fe1\u5fc5\u987b\u7ecf\u8fc7 Server</li> </ol>"},{"location":"specification/architecture/#_5","title":"\u901a\u4fe1\u6a21\u578b","text":""},{"location":"specification/architecture/#_6","title":"\u4f20\u8f93\u5c42","text":"<p>A2C-SMCP \u534f\u8bae\u8fd0\u884c\u5728 Socket.IO \u4e4b\u4e0a\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           A2C-SMCP \u534f\u8bae              \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502           Socket.IO                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502      WebSocket / HTTP \u957f\u8f6e\u8be2         \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502           TCP/TLS                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/architecture/#_7","title":"\u547d\u540d\u7a7a\u95f4","text":"<p>\u6240\u6709\u534f\u8bae\u4e8b\u4ef6\u901a\u8fc7\u7edf\u4e00\u547d\u540d\u7a7a\u95f4\u4f20\u8f93\uff1a</p> <pre><code>SMCP_NAMESPACE = \"/smcp\"\n</code></pre>"},{"location":"specification/architecture/#_8","title":"\u6d88\u606f\u6d41\u5411","text":"<pre><code>             client:*                     client:*\n    Agent \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 Server \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192 Computer\n      \u2502                    \u2502                      \u2502\n      \u2502                    \u2502                      \u2502\n      \u2502    notify:*        \u2502       server:*       \u2502\n      \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n                           \u2502\n                           \u2502 notify:* (\u5e7f\u64ad)\n                           \u25bc\n                    \u623f\u95f4\u5185\u6240\u6709\u6210\u5458\n</code></pre>"},{"location":"specification/architecture/#_9","title":"\u4e8b\u4ef6\u8def\u7531\u673a\u5236","text":""},{"location":"specification/architecture/#_10","title":"\u4e8b\u4ef6\u524d\u7f00\u7ea6\u5b9a","text":"\u524d\u7f00 \u65b9\u5411 \u5904\u7406\u65b9 \u8bf4\u660e <code>client:</code> Agent \u2192 Computer Computer \u7531 Server \u8def\u7531\u5230\u6307\u5b9a Computer <code>server:</code> \u5ba2\u6237\u7aef \u2192 Server Server \u7531 Server \u76f4\u63a5\u5904\u7406 <code>notify:</code> Server \u2192 \u5e7f\u64ad Agent/Computer \u5e7f\u64ad\u5230\u623f\u95f4\u5185\u6240\u6709\u6210\u5458"},{"location":"specification/architecture/#_11","title":"\u8def\u7531\u6d41\u7a0b","text":""},{"location":"specification/architecture/#client","title":"Client \u4e8b\u4ef6\u8def\u7531","text":"<pre><code>1. Agent \u53d1\u9001 client:tool_call\uff0c\u6307\u5b9a\u76ee\u6807 computer\n2. Server \u63a5\u6536\u4e8b\u4ef6\n3. Server \u9a8c\u8bc1 Agent \u548c Computer \u5728\u540c\u4e00\u623f\u95f4\n4. Server \u901a\u8fc7 name \u2192 sid \u6620\u5c04\u627e\u5230\u76ee\u6807 Computer\n5. Server \u8f6c\u53d1\u4e8b\u4ef6\u5230 Computer\n6. Computer \u6267\u884c\u5e76\u8fd4\u56de\u7ed3\u679c\n7. Server \u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9 Agent\n</code></pre>"},{"location":"specification/architecture/#server","title":"Server \u4e8b\u4ef6\u5904\u7406","text":"<pre><code>1. \u5ba2\u6237\u7aef\u53d1\u9001 server:join_office\n2. Server \u63a5\u6536\u5e76\u9a8c\u8bc1\u8bf7\u6c42\n3. Server \u6267\u884c\u623f\u95f4\u52a0\u5165\u903b\u8f91\n4. Server \u8fd4\u56de\u5904\u7406\u7ed3\u679c\n5. Server \u5e7f\u64ad notify:enter_office \u5230\u623f\u95f4\n</code></pre>"},{"location":"specification/architecture/#_12","title":"\u6838\u5fc3\u7ec4\u4ef6","text":""},{"location":"specification/architecture/#server_1","title":"Server \u7aef\u7ec4\u4ef6","text":"<pre><code>a2c_smcp/server/\n\u251c\u2500\u2500 auth.py           # \u8ba4\u8bc1\u7cfb\u7edf\uff08AuthenticationProvider\uff09\n\u251c\u2500\u2500 base.py           # \u57fa\u7840\u547d\u540d\u7a7a\u95f4\uff08BaseNamespace\uff09\n\u251c\u2500\u2500 namespace.py      # SMCP \u534f\u8bae\u547d\u540d\u7a7a\u95f4\uff08SMCPNamespace\uff09\n\u251c\u2500\u2500 sync_namespace.py # \u540c\u6b65\u7248\u672c\u547d\u540d\u7a7a\u95f4\n\u251c\u2500\u2500 types.py          # \u7c7b\u578b\u5b9a\u4e49\n\u2514\u2500\u2500 utils.py          # \u5de5\u5177\u51fd\u6570\n</code></pre> <p>\u6838\u5fc3\u7c7b:</p> <ul> <li><code>AuthenticationProvider</code>: \u8ba4\u8bc1\u62bd\u8c61\u57fa\u7c7b</li> <li><code>BaseNamespace</code>: \u57fa\u7840\u547d\u540d\u7a7a\u95f4\uff0c\u63d0\u4f9b\u8fde\u63a5\u7ba1\u7406\u548c name \u6620\u5c04</li> <li><code>SMCPNamespace</code>: SMCP \u534f\u8bae\u5b9e\u73b0\uff0c\u5904\u7406\u6240\u6709\u534f\u8bae\u4e8b\u4ef6</li> </ul>"},{"location":"specification/architecture/#agent","title":"Agent \u7aef\u7ec4\u4ef6","text":"<pre><code>a2c_smcp/agent/\n\u251c\u2500\u2500 auth.py         # Agent \u8ba4\u8bc1\u63d0\u4f9b\u8005\n\u251c\u2500\u2500 base.py         # \u57fa\u7840\u5ba2\u6237\u7aef\u62bd\u8c61\n\u251c\u2500\u2500 client.py       # \u5f02\u6b65\u5ba2\u6237\u7aef\uff08AsyncSMCPAgentClient\uff09\n\u251c\u2500\u2500 sync_client.py  # \u540c\u6b65\u5ba2\u6237\u7aef\uff08SMCPAgentClient\uff09\n\u2514\u2500\u2500 types.py        # \u7c7b\u578b\u5b9a\u4e49\u548c\u4e8b\u4ef6\u5904\u7406\u534f\u8bae\n</code></pre> <p>\u6838\u5fc3\u7c7b:</p> <ul> <li><code>AgentAuthProvider</code>: Agent \u8ba4\u8bc1\u62bd\u8c61\u57fa\u7c7b</li> <li><code>AsyncSMCPAgentClient</code>: \u5f02\u6b65 Agent \u5ba2\u6237\u7aef</li> <li><code>SMCPAgentClient</code>: \u540c\u6b65 Agent \u5ba2\u6237\u7aef</li> </ul>"},{"location":"specification/architecture/#computer","title":"Computer \u7aef\u7ec4\u4ef6","text":"<pre><code>a2c_smcp/computer/\n\u251c\u2500\u2500 computer.py           # Computer \u4e3b\u7c7b\n\u251c\u2500\u2500 base.py               # \u57fa\u7840\u62bd\u8c61\u7c7b\n\u251c\u2500\u2500 socketio/\n\u2502   \u2514\u2500\u2500 client.py         # Socket.IO \u5ba2\u6237\u7aef\uff08SMCPComputerClient\uff09\n\u251c\u2500\u2500 mcp_clients/\n\u2502   \u251c\u2500\u2500 manager.py        # MCP \u670d\u52a1\u5668\u7ba1\u7406\u5668\n\u2502   \u251c\u2500\u2500 base_client.py    # MCP \u5ba2\u6237\u7aef\u57fa\u7c7b\n\u2502   \u251c\u2500\u2500 stdio_client.py   # Stdio \u5ba2\u6237\u7aef\n\u2502   \u251c\u2500\u2500 sse_client.py     # SSE \u5ba2\u6237\u7aef\n\u2502   \u2514\u2500\u2500 http_client.py    # HTTP \u5ba2\u6237\u7aef\n\u251c\u2500\u2500 desktop/\n\u2502   \u2514\u2500\u2500 organize.py       # \u684c\u9762\u7ec4\u7ec7\u903b\u8f91\n\u2514\u2500\u2500 inputs/\n    \u2514\u2500\u2500 resolver.py       # \u8f93\u5165\u89e3\u6790\u5668\n</code></pre> <p>\u6838\u5fc3\u7c7b:</p> <ul> <li><code>Computer</code>: Computer \u4e3b\u7c7b\uff0c\u7ba1\u7406 MCP \u670d\u52a1\u5668\u548c\u5de5\u5177</li> <li><code>SMCPComputerClient</code>: Socket.IO \u5ba2\u6237\u7aef\uff0c\u5904\u7406 SMCP \u534f\u8bae\u901a\u4fe1</li> <li><code>MCPServerManager</code>: MCP \u670d\u52a1\u5668\u751f\u547d\u5468\u671f\u7ba1\u7406</li> </ul>"},{"location":"specification/architecture/#name","title":"Name \u6620\u5c04\u7cfb\u7edf","text":"<p>Server \u901a\u8fc7 name \u6620\u5c04\u7cfb\u7edf\u5b9e\u73b0 Agent/Computer \u7684\u5b9a\u4f4d\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Server \u5185\u90e8\u72b6\u6001                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  name_to_sid: dict[str, str]                \u2502\n\u2502    \"agent-1\"    \u2192 \"abc123...\"               \u2502\n\u2502    \"computer-1\" \u2192 \"def456...\"               \u2502\n\u2502    \"computer-2\" \u2192 \"ghi789...\"               \u2502\n\u2502                                              \u2502\n\u2502  sessions: dict[str, Session]               \u2502\n\u2502    \"abc123...\" \u2192 {name, role, office_id}    \u2502\n\u2502    \"def456...\" \u2192 {name, role, office_id}    \u2502\n\u2502                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/architecture/#_13","title":"\u6620\u5c04\u751f\u547d\u5468\u671f","text":"<ol> <li>\u6ce8\u518c: \u5ba2\u6237\u7aef\u52a0\u5165\u623f\u95f4\u65f6\uff0c\u6ce8\u518c name \u2192 sid \u6620\u5c04</li> <li>\u67e5\u8be2: \u8def\u7531\u4e8b\u4ef6\u65f6\uff0c\u901a\u8fc7 name \u67e5\u627e\u76ee\u6807 sid</li> <li>\u6ce8\u9500: \u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5\u6216\u79bb\u5f00\u623f\u95f4\u65f6\uff0c\u6e05\u9664\u6620\u5c04</li> </ol>"},{"location":"specification/architecture/#_14","title":"\u623f\u95f4\u6a21\u578b","text":""},{"location":"specification/architecture/#_15","title":"\u623f\u95f4\u7ed3\u6784","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Office (Room)                   \u2502\n\u2502              office_id: \"room-001\"           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                              \u2502\n\u2502  Agent: agent-1 (sid: abc123)               \u2502\n\u2502                                              \u2502\n\u2502  Computers:                                  \u2502\n\u2502    - computer-1 (sid: def456)               \u2502\n\u2502    - computer-2 (sid: ghi789)               \u2502\n\u2502                                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/architecture/#_16","title":"\u9694\u79bb\u4fdd\u969c","text":"\u7ea6\u675f \u8bf4\u660e Agent \u72ec\u5360 \u623f\u95f4\u5df2\u6709 Agent \u65f6\uff0c\u62d2\u7edd\u65b0 Agent \u52a0\u5165 Computer \u7ed1\u5b9a Computer \u52a0\u5165\u65b0\u623f\u95f4\u65f6\uff0c\u81ea\u52a8\u79bb\u5f00\u65e7\u623f\u95f4 \u8de8\u623f\u95f4\u7981\u6b62 \u4e0d\u5141\u8bb8\u8bbf\u95ee\u5176\u4ed6\u623f\u95f4\u7684\u8d44\u6e90"},{"location":"specification/architecture/#mcp","title":"\u4e0e MCP \u7684\u96c6\u6210","text":"<p>Computer \u4f5c\u4e3a MCP Server \u7684\u5bbf\u4e3b\uff0c\u5b9e\u73b0\u4e86\u4e0e MCP \u534f\u8bae\u7684\u6865\u63a5\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Computer                            \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502              MCPServerManager                    \u2502    \u2502\n\u2502  \u2502                                                  \u2502    \u2502\n\u2502  \u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502    \u2502\n\u2502  \u2502   \u2502MCP Client\u2502  \u2502MCP Client\u2502  \u2502MCP Client\u2502     \u2502    \u2502\n\u2502  \u2502   \u2502 (Stdio)  \u2502  \u2502  (SSE)   \u2502  \u2502(Streamable)\u2502   \u2502    \u2502\n\u2502  \u2502   \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518     \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502           \u2502             \u2502             \u2502                 \u2502\n\u2502           \u25bc             \u25bc             \u25bc                 \u2502\n\u2502      \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502\n\u2502      \u2502MCP Srv1\u2502    \u2502MCP Srv2\u2502    \u2502MCP Srv3\u2502            \u2502\n\u2502      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/architecture/#_17","title":"\u5de5\u5177\u805a\u5408","text":"<ol> <li>Computer \u4ece\u591a\u4e2a MCP Server \u6536\u96c6\u5de5\u5177\u5b9a\u4e49</li> <li>\u7edf\u4e00\u8f6c\u6362\u4e3a <code>SMCPTool</code> \u683c\u5f0f</li> <li>\u901a\u8fc7\u522b\u540d\u673a\u5236\u89e3\u51b3\u5de5\u5177\u540d\u51b2\u7a81</li> <li>\u5bf9\u5916\u66b4\u9732\u7edf\u4e00\u7684\u5de5\u5177\u89c6\u56fe</li> </ol>"},{"location":"specification/architecture/#_18","title":"\u8d44\u6e90\u6620\u5c04","text":"<p>MCP Resources \u88ab\u6620\u5c04\u4e3a Desktop \u80fd\u529b\uff1a</p> <ul> <li><code>resources/list</code> \u2192 \u7b5b\u9009 <code>window://</code> \u8d44\u6e90</li> <li><code>resources/read</code> \u2192 \u8bfb\u53d6\u7a97\u53e3\u5185\u5bb9</li> <li><code>resources/subscribe</code> \u2192 \u89e6\u53d1\u684c\u9762\u5237\u65b0\u901a\u77e5</li> </ul>"},{"location":"specification/architecture/#_19","title":"\u540c\u6b65/\u5f02\u6b65\u53cc\u6808","text":"<p>Server \u548c Agent \u6a21\u5757\u5747\u63d0\u4f9b\u540c\u6b65\u548c\u5f02\u6b65\u4e24\u79cd\u5b9e\u73b0\uff1a</p> \u6a21\u5757 \u5f02\u6b65\u5b9e\u73b0 \u540c\u6b65\u5b9e\u73b0 Server <code>SMCPNamespace</code> <code>SyncSMCPNamespace</code> Agent <code>AsyncSMCPAgentClient</code> <code>SMCPAgentClient</code> <p>\u6ce8\u610f: \u4fee\u6539\u534f\u8bae\u903b\u8f91\u65f6\uff0c\u5fc5\u987b\u540c\u65f6\u66f4\u65b0\u4e24\u4e2a\u7248\u672c\u4ee5\u4fdd\u6301\u4e00\u81f4\u6027\u3002</p>"},{"location":"specification/architecture/#_20","title":"\u53c2\u8003","text":"<ul> <li>Server \u5b9e\u73b0: <code>a2c_smcp/server/</code></li> <li>Agent \u5b9e\u73b0: <code>a2c_smcp/agent/</code></li> <li>Computer \u5b9e\u73b0: <code>a2c_smcp/computer/</code></li> <li>\u534f\u8bae\u5b9a\u4e49: <code>a2c_smcp/smcp.py</code></li> </ul>"},{"location":"specification/data-structures/","title":"A2C-SMCP \u6570\u636e\u7ed3\u6784\u5b9a\u4e49","text":"<p>\u672c\u6587\u6863\u5b9a\u4e49\u4e86 A2C-SMCP \u534f\u8bae\u7684\u6240\u6709\u6570\u636e\u7ed3\u6784\uff0c\u57fa\u4e8e <code>a2c_smcp/smcp.py</code> \u4e2d\u7684 TypedDict \u5b9a\u4e49\u3002</p>"},{"location":"specification/data-structures/#_1","title":"\u901a\u7528\u7ea6\u5b9a","text":"<ul> <li>\u6240\u6709\u6570\u636e\u7ed3\u6784\u4f7f\u7528 JSON \u5bf9\u8c61\u8868\u793a</li> <li>\u5b57\u6bb5\u547d\u540d\u4f7f\u7528 <code>snake_case</code> \u98ce\u683c</li> <li>\u53ef\u9009\u5b57\u6bb5\u4f7f\u7528 <code>NotRequired</code> \u6807\u6ce8</li> <li>\u65f6\u95f4\u76f8\u5173\u5b57\u6bb5\uff1a\u8d85\u65f6\u4f7f\u7528\u6574\u6570\u79d2</li> </ul>"},{"location":"specification/data-structures/#_2","title":"\u57fa\u7840\u6570\u636e\u7ed3\u6784","text":""},{"location":"specification/data-structures/#agentcalldata","title":"AgentCallData","text":"<p>Agent \u53d1\u8d77\u8c03\u7528\u7684\u57fa\u7840\u6570\u636e\uff0c\u88ab\u591a\u4e2a\u8bf7\u6c42\u7ed3\u6784\u7ee7\u627f\u3002</p> <pre><code>class AgentCallData(TypedDict):\n    agent: str      # Agent \u540d\u79f0/\u6807\u8bc6\n    req_id: str     # \u8bf7\u6c42 ID\uff0c\u7528\u4e8e\u53bb\u91cd\u548c\u5173\u8054\n</code></pre>"},{"location":"specification/data-structures/#_3","title":"\u5de5\u5177\u76f8\u5173\u7ed3\u6784","text":""},{"location":"specification/data-structures/#toolcallreq","title":"ToolCallReq","text":"<p>\u5de5\u5177\u8c03\u7528\u8bf7\u6c42\uff0c\u7ee7\u627f\u81ea <code>AgentCallData</code>\u3002</p> <pre><code>class ToolCallReq(AgentCallData):\n    agent: str          # Agent \u540d\u79f0\n    req_id: str         # \u8bf7\u6c42 ID\n    computer: str       # \u76ee\u6807 Computer \u540d\u79f0\n    tool_name: str      # \u5de5\u5177\u540d\u79f0\n    params: dict        # \u5de5\u5177\u8c03\u7528\u53c2\u6570\n    timeout: int        # \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\n</code></pre>"},{"location":"specification/data-structures/#smcptool","title":"SMCPTool","text":"<p>SMCP \u534f\u8bae\u4e2d\u7684\u5de5\u5177\u5b9a\u4e49\uff0c\u7528\u4e8e\u5de5\u5177\u5217\u8868\u8fd4\u56de\u3002</p> <pre><code>class SMCPTool(TypedDict):\n    name: str                           # \u5de5\u5177\u540d\u79f0\n    description: str                    # \u5de5\u5177\u63cf\u8ff0\n    params_schema: dict                 # \u53c2\u6570 JSON Schema\n    return_schema: dict | None          # \u8fd4\u56de\u503c JSON Schema\uff08\u53ef\u9009\uff09\n    meta: NotRequired[Attributes | None]  # \u5de5\u5177\u5143\u6570\u636e\uff08\u53ef\u9009\uff09\n</code></pre> <p>\u8bf4\u660e: \u5f53 Computer \u7ba1\u7406\u591a\u4e2a MCP Server \u65f6\uff0c\u53ef\u80fd\u5b58\u5728\u5de5\u5177\u540d\u79f0\u51b2\u7a81\u3002\u6b64\u65f6\u53ef\u901a\u8fc7 <code>meta</code> \u4e2d\u7684 <code>alias</code> \u5b57\u6bb5\u8bbe\u7f6e\u522b\u540d\u8fdb\u884c\u533a\u5206\u3002</p>"},{"location":"specification/data-structures/#toolmeta","title":"ToolMeta","text":"<p>\u5de5\u5177\u5143\u6570\u636e\u914d\u7f6e\u3002</p> <pre><code>class ToolMeta(TypedDict, total=False):\n    auto_apply: NotRequired[bool | None]\n    # \u662f\u5426\u81ea\u52a8\u5e94\u7528\uff08\u8df3\u8fc7\u4e8c\u6b21\u786e\u8ba4\uff09\n\n    ret_object_mapper: NotRequired[dict | None]\n    # \u8fd4\u56de\u503c\u5bf9\u8c61\u6620\u5c04\uff0c\u7528\u4e8e\u7edf\u4e00\u4e0d\u540c MCP \u5de5\u5177\u7684\u8fd4\u56de\u683c\u5f0f\n\n    alias: NotRequired[str | None]\n    # \u5de5\u5177\u522b\u540d\uff0c\u7528\u4e8e\u89e3\u51b3\u4e0d\u540c Server \u4e0b\u7684\u5de5\u5177\u91cd\u540d\u51b2\u7a81\n\n    tags: NotRequired[list[str] | None]\n    # \u5de5\u5177\u6807\u7b7e\uff0c\u7528\u4e8e\u5206\u7c7b\n</code></pre>"},{"location":"specification/data-structures/#gettoolsreq","title":"GetToolsReq","text":"<p>\u83b7\u53d6\u5de5\u5177\u5217\u8868\u8bf7\u6c42\u3002</p> <pre><code>class GetToolsReq(AgentCallData):\n    agent: str      # Agent \u540d\u79f0\n    req_id: str     # \u8bf7\u6c42 ID\n    computer: str   # \u76ee\u6807 Computer \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#gettoolsret","title":"GetToolsRet","text":"<p>\u83b7\u53d6\u5de5\u5177\u5217\u8868\u54cd\u5e94\u3002</p> <pre><code>class GetToolsRet(TypedDict):\n    tools: list[SMCPTool]   # \u5de5\u5177\u5217\u8868\n    req_id: str             # \u8bf7\u6c42 ID\n</code></pre>"},{"location":"specification/data-structures/#_4","title":"\u623f\u95f4\u7ba1\u7406\u7ed3\u6784","text":""},{"location":"specification/data-structures/#enterofficereq","title":"EnterOfficeReq","text":"<p>\u52a0\u5165\u623f\u95f4\u8bf7\u6c42\u3002</p> <pre><code>class EnterOfficeReq(TypedDict):\n    role: Literal[\"computer\", \"agent\"]  # \u89d2\u8272\u7c7b\u578b\n    name: str                           # \u540d\u79f0\n    office_id: str                      # \u623f\u95f4 ID\n</code></pre>"},{"location":"specification/data-structures/#leaveofficereq","title":"LeaveOfficeReq","text":"<p>\u79bb\u5f00\u623f\u95f4\u8bf7\u6c42\u3002</p> <pre><code>class LeaveOfficeReq(TypedDict):\n    office_id: str      # \u623f\u95f4 ID\n</code></pre>"},{"location":"specification/data-structures/#enterofficenotification","title":"EnterOfficeNotification","text":"<p>\u6210\u5458\u52a0\u5165\u623f\u95f4\u901a\u77e5\u3002</p> <pre><code>class EnterOfficeNotification(TypedDict, total=False):\n    office_id: str              # \u623f\u95f4 ID\n    computer: str | None        # \u52a0\u5165\u7684 Computer \u540d\u79f0\uff08\u82e5\u4e3a Computer\uff09\n    agent: str | None           # \u52a0\u5165\u7684 Agent \u540d\u79f0\uff08\u82e5\u4e3a Agent\uff09\n</code></pre>"},{"location":"specification/data-structures/#leaveofficenotification","title":"LeaveOfficeNotification","text":"<p>\u6210\u5458\u79bb\u5f00\u623f\u95f4\u901a\u77e5\u3002</p> <pre><code>class LeaveOfficeNotification(TypedDict, total=False):\n    office_id: str              # \u623f\u95f4 ID\n    computer: str | None        # \u79bb\u5f00\u7684 Computer \u540d\u79f0\n    agent: str | None           # \u79bb\u5f00\u7684 Agent \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#listroomreq","title":"ListRoomReq","text":"<p>\u5217\u51fa\u623f\u95f4\u5185\u4f1a\u8bdd\u8bf7\u6c42\u3002</p> <pre><code>class ListRoomReq(AgentCallData):\n    agent: str          # Agent \u540d\u79f0\n    req_id: str         # \u8bf7\u6c42 ID\n    office_id: str      # \u623f\u95f4 ID\n</code></pre>"},{"location":"specification/data-structures/#sessioninfo","title":"SessionInfo","text":"<p>\u4f1a\u8bdd\u4fe1\u606f\u3002</p> <pre><code>class SessionInfo(TypedDict, total=False):\n    sid: str                                # \u4f1a\u8bdd ID\n    name: str                               # \u4f1a\u8bdd\u540d\u79f0\n    role: Literal[\"computer\", \"agent\"]      # \u89d2\u8272\n    office_id: str                          # \u6240\u5c5e\u623f\u95f4 ID\n</code></pre>"},{"location":"specification/data-structures/#listroomret","title":"ListRoomRet","text":"<p>\u5217\u51fa\u623f\u95f4\u5185\u4f1a\u8bdd\u54cd\u5e94\u3002</p> <pre><code>class ListRoomRet(TypedDict):\n    sessions: list[SessionInfo]     # \u4f1a\u8bdd\u5217\u8868\n    req_id: str                     # \u8bf7\u6c42 ID\n</code></pre>"},{"location":"specification/data-structures/#_5","title":"\u914d\u7f6e\u76f8\u5173\u7ed3\u6784","text":""},{"location":"specification/data-structures/#updatecomputerconfigreq","title":"UpdateComputerConfigReq","text":"<p>\u914d\u7f6e\u66f4\u65b0\u8bf7\u6c42\u3002</p> <pre><code>class UpdateComputerConfigReq(TypedDict):\n    computer: str       # Computer \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#updatemcpconfignotification","title":"UpdateMCPConfigNotification","text":"<p>\u914d\u7f6e\u66f4\u65b0\u901a\u77e5\u3002</p> <pre><code>class UpdateMCPConfigNotification(TypedDict, total=False):\n    computer: str       # Computer \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#updatetoollistnotification","title":"UpdateToolListNotification","text":"<p>\u5de5\u5177\u5217\u8868\u66f4\u65b0\u901a\u77e5\u3002</p> <pre><code>class UpdateToolListNotification(TypedDict, total=False):\n    computer: str       # Computer \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#getcomputerconfigreq","title":"GetComputerConfigReq","text":"<p>\u83b7\u53d6 Computer \u914d\u7f6e\u8bf7\u6c42\u3002</p> <pre><code>class GetComputerConfigReq(AgentCallData):\n    agent: str          # Agent \u540d\u79f0\n    req_id: str         # \u8bf7\u6c42 ID\n    computer: str       # \u76ee\u6807 Computer \u540d\u79f0\n</code></pre>"},{"location":"specification/data-structures/#getcomputerconfigret","title":"GetComputerConfigRet","text":"<p>\u83b7\u53d6 Computer \u914d\u7f6e\u54cd\u5e94\u3002</p> <pre><code>class GetComputerConfigRet(TypedDict):\n    inputs: NotRequired[list[MCPServerInput] | None]    # \u8f93\u5165\u5b9a\u4e49\u5217\u8868\n    servers: dict[str, MCPServerConfig]                 # MCP Server \u914d\u7f6e\u6620\u5c04\n</code></pre>"},{"location":"specification/data-structures/#desktop","title":"Desktop \u76f8\u5173\u7ed3\u6784","text":""},{"location":"specification/data-structures/#getdesktopreq","title":"GetDeskTopReq","text":"<p>\u83b7\u53d6\u684c\u9762\u4fe1\u606f\u8bf7\u6c42\u3002</p> <pre><code>class GetDeskTopReq(AgentCallData, total=True):\n    agent: str                      # Agent \u540d\u79f0\n    req_id: str                     # \u8bf7\u6c42 ID\n    computer: str                   # \u76ee\u6807 Computer \u540d\u79f0\n    desktop_size: NotRequired[int]  # \u53ef\u9009\uff1a\u9650\u5236\u8fd4\u56de\u7684\u684c\u9762\u5185\u5bb9\u6570\u91cf\n    window: NotRequired[str]        # \u53ef\u9009\uff1a\u6307\u5b9a\u83b7\u53d6\u7684 WindowURI\n</code></pre>"},{"location":"specification/data-structures/#getdesktopret","title":"GetDeskTopRet","text":"<p>\u83b7\u53d6\u684c\u9762\u4fe1\u606f\u54cd\u5e94\u3002</p> <pre><code>Desktop: TypeAlias = str\n\nclass GetDeskTopRet(TypedDict, total=False):\n    desktops: list[Desktop]     # \u684c\u9762\u5185\u5bb9\u5217\u8868\uff08\u5b57\u7b26\u4e32\u5f62\u5f0f\uff09\n    req_id: str                 # \u8bf7\u6c42 ID\n</code></pre>"},{"location":"specification/data-structures/#mcp-server","title":"MCP Server \u914d\u7f6e\u7ed3\u6784","text":""},{"location":"specification/data-structures/#basemcpserverconfig","title":"BaseMCPServerConfig","text":"<p>MCP Server \u914d\u7f6e\u57fa\u7c7b\u3002</p> <pre><code>class BaseMCPServerConfig(TypedDict):\n    name: str\n    # MCP Server \u540d\u79f0\n\n    disabled: bool\n    # \u662f\u5426\u7981\u7528\n\n    forbidden_tools: list[str]\n    # \u7981\u7528\u7684\u5de5\u5177\u5217\u8868\n\n    tool_meta: dict[str, ToolMeta]\n    # \u5de5\u5177\u5143\u6570\u636e\u6620\u5c04\uff08\u5de5\u5177\u540d \u2192 \u5143\u6570\u636e\uff09\n\n    default_tool_meta: NotRequired[ToolMeta | None]\n    # \u9ed8\u8ba4\u5de5\u5177\u5143\u6570\u636e\uff0c\u5f53\u5177\u4f53\u5de5\u5177\u672a\u914d\u7f6e\u65f6\u4f7f\u7528\n\n    vrl: NotRequired[str | None]\n    # VRL \u811a\u672c\uff0c\u7528\u4e8e\u52a8\u6001\u8f6c\u6362\u5de5\u5177\u8fd4\u56de\u503c\n</code></pre>"},{"location":"specification/data-structures/#mcpserverstdioconfig","title":"MCPServerStdioConfig","text":"<p>\u6807\u51c6\u8f93\u5165\u8f93\u51fa\u6a21\u5f0f\u7684 MCP Server \u914d\u7f6e\u3002</p> <pre><code>class MCPServerStdioParameters(TypedDict):\n    command: str\n    # \u542f\u52a8\u547d\u4ee4\n\n    args: list[str]\n    # \u547d\u4ee4\u884c\u53c2\u6570\n\n    env: dict[str, str] | None\n    # \u73af\u5883\u53d8\u91cf\n\n    cwd: str | None\n    # \u5de5\u4f5c\u76ee\u5f55\n\n    encoding: str\n    # \u6587\u672c\u7f16\u7801\uff0c\u9ed8\u8ba4 utf-8\n\n    encoding_error_handler: Literal[\"strict\", \"ignore\", \"replace\"]\n    # \u7f16\u7801\u9519\u8bef\u5904\u7406\u65b9\u5f0f\n\n\nclass MCPServerStdioConfig(BaseMCPServerConfig):\n    type: Literal[\"stdio\"]\n    server_parameters: MCPServerStdioParameters\n</code></pre>"},{"location":"specification/data-structures/#mcpserverstreamablehttpconfig","title":"MCPServerStreamableHttpConfig","text":"<p>Streamable HTTP \u6a21\u5f0f\u7684 MCP Server \u914d\u7f6e\u3002</p> <pre><code>class MCPServerStreamableHttpParameters(TypedDict):\n    url: str\n    # \u7aef\u70b9 URL\n\n    headers: dict[str, Any] | None\n    # \u8bf7\u6c42\u5934\n\n    timeout: str\n    # HTTP \u8d85\u65f6\uff08ISO 8601 duration \u683c\u5f0f\uff09\n\n    sse_read_timeout: str\n    # SSE \u8bfb\u53d6\u8d85\u65f6\uff08ISO 8601 duration \u683c\u5f0f\uff09\n\n    terminate_on_close: bool\n    # \u5173\u95ed\u65f6\u662f\u5426\u7ec8\u6b62\u5ba2\u6237\u7aef\u4f1a\u8bdd\n\n\nclass MCPServerStreamableHttpConfig(BaseMCPServerConfig):\n    type: Literal[\"streamable\"]\n    server_parameters: MCPServerStreamableHttpParameters\n</code></pre>"},{"location":"specification/data-structures/#mcpsseconfig","title":"MCPSSEConfig","text":"<p>SSE \u6a21\u5f0f\u7684 MCP Server \u914d\u7f6e\u3002</p> <pre><code>class MCPSSEParameters(TypedDict):\n    url: str\n    # \u7aef\u70b9 URL\n\n    headers: dict[str, Any] | None\n    # \u8bf7\u6c42\u5934\n\n    timeout: float\n    # HTTP \u8d85\u65f6\uff08\u79d2\uff09\n\n    sse_read_timeout: float\n    # SSE \u8bfb\u53d6\u8d85\u65f6\uff08\u79d2\uff09\n\n\nclass MCPSSEConfig(BaseMCPServerConfig):\n    type: Literal[\"sse\"]\n    server_parameters: MCPSSEParameters\n</code></pre>"},{"location":"specification/data-structures/#mcpserverconfig","title":"MCPServerConfig","text":"<p>MCP Server \u914d\u7f6e\u8054\u5408\u7c7b\u578b\u3002</p> <pre><code>MCPServerConfig = MCPServerStdioConfig | MCPServerStreamableHttpConfig | MCPSSEConfig\n</code></pre> <p>\u6ce8\u610f: MCP Server \u7c7b\u578b\u4e3a <code>\"stdio\"</code>, <code>\"streamable\"</code>, <code>\"sse\"</code> \u4e09\u79cd\uff0c\u5176\u4e2d <code>\"streamable\"</code> \u5bf9\u5e94 MCP \u5b98\u65b9\u7684 Streamable HTTP \u4f20\u8f93\u6a21\u5f0f\u3002</p>"},{"location":"specification/data-structures/#_6","title":"\u8f93\u5165\u914d\u7f6e\u7ed3\u6784","text":"<p>\u8f93\u5165\u914d\u7f6e\u7528\u4e8e\u5b9a\u4e49 MCP Server \u914d\u7f6e\u4e2d\u7684\u52a8\u6001\u5360\u4f4d\u7b26\u3002</p>"},{"location":"specification/data-structures/#mcpserverinputbase","title":"MCPServerInputBase","text":"<p>\u8f93\u5165\u914d\u7f6e\u57fa\u7c7b\u3002</p> <pre><code>class MCPServerInputBase(TypedDict):\n    id: str             # \u8f93\u5165 ID\n    description: str    # \u63cf\u8ff0\n</code></pre>"},{"location":"specification/data-structures/#mcpserverpromptstringinput","title":"MCPServerPromptStringInput","text":"<p>\u5b57\u7b26\u4e32\u8f93\u5165\u7c7b\u578b\u3002</p> <pre><code>class MCPServerPromptStringInput(MCPServerInputBase):\n    type: Literal[\"promptString\"]\n    default: NotRequired[str | None]        # \u9ed8\u8ba4\u503c\n    password: NotRequired[bool | None]      # \u662f\u5426\u4e3a\u5bc6\u7801\uff08\u9690\u85cf\u8f93\u5165\uff09\n</code></pre>"},{"location":"specification/data-structures/#mcpserverpickstringinput","title":"MCPServerPickStringInput","text":"<p>\u9009\u62e9\u8f93\u5165\u7c7b\u578b\u3002</p> <pre><code>class MCPServerPickStringInput(MCPServerInputBase):\n    type: Literal[\"pickString\"]\n    options: list[str]                      # \u53ef\u9009\u9879\u5217\u8868\n    default: NotRequired[str | None]        # \u9ed8\u8ba4\u503c\n</code></pre>"},{"location":"specification/data-structures/#mcpservercommandinput","title":"MCPServerCommandInput","text":"<p>\u547d\u4ee4\u8f93\u5165\u7c7b\u578b\uff08\u901a\u8fc7\u6267\u884c\u547d\u4ee4\u83b7\u53d6\u503c\uff09\u3002</p> <pre><code>class MCPServerCommandInput(MCPServerInputBase):\n    type: Literal[\"command\"]\n    command: str                            # \u8981\u6267\u884c\u7684\u547d\u4ee4\n    args: NotRequired[dict[str, str] | None]  # \u547d\u4ee4\u53c2\u6570\n</code></pre>"},{"location":"specification/data-structures/#mcpserverinput","title":"MCPServerInput","text":"<p>\u8f93\u5165\u914d\u7f6e\u8054\u5408\u7c7b\u578b\u3002</p> <pre><code>MCPServerInput = MCPServerPromptStringInput | MCPServerPickStringInput | MCPServerCommandInput\n</code></pre>"},{"location":"specification/data-structures/#_7","title":"\u7c7b\u578b\u522b\u540d","text":"<pre><code>from a2c_smcp.types import SERVER_NAME, TOOL_NAME, Attributes, AttributeValue\n\nSERVER_NAME: TypeAlias = str    # MCP Server \u540d\u79f0\nTOOL_NAME: TypeAlias = str      # \u5de5\u5177\u540d\u79f0\nAttributeValue: TypeAlias = str | int | float | bool | None\nAttributes: TypeAlias = dict[str, AttributeValue]\nDesktop: TypeAlias = str        # \u684c\u9762\u5185\u5bb9\uff08\u5b57\u7b26\u4e32\u5f62\u5f0f\uff09\n</code></pre>"},{"location":"specification/data-structures/#_8","title":"\u53c2\u8003","text":"<ul> <li>\u7c7b\u578b\u5b9a\u4e49\u6e90\u7801: <code>a2c_smcp/smcp.py</code></li> <li>Pydantic \u6a21\u578b: <code>a2c_smcp/computer/mcp_clients/model.py</code></li> <li>\u901a\u7528\u7c7b\u578b: <code>a2c_smcp/types.py</code></li> </ul>"},{"location":"specification/error-handling/","title":"A2C-SMCP \u9519\u8bef\u5904\u7406\u89c4\u8303","text":"<p>\u72b6\u6001: \u8349\u6848</p> <p>\u672c\u7ae0\u8282\u76ee\u524d\u4e3a\u8349\u6848\u72b6\u6001\uff0c\u5177\u4f53\u9519\u8bef\u7801\u4e0e\u7ed3\u6784\u4ecd\u5728\u6f14\u8fdb\u4e2d\u3002</p>"},{"location":"specification/error-handling/#_1","title":"\u6982\u8ff0","text":"<p>A2C-SMCP \u534f\u8bae\u5b9a\u4e49\u4e86\u7edf\u4e00\u7684\u9519\u8bef\u5904\u7406\u673a\u5236\uff0c\u786e\u4fdd Agent\u3001Server\u3001Computer \u4e4b\u95f4\u80fd\u591f\u6b63\u786e\u4f20\u9012\u548c\u5904\u7406\u9519\u8bef\u4fe1\u606f\u3002</p>"},{"location":"specification/error-handling/#_2","title":"\u9519\u8bef\u7801\u5b9a\u4e49","text":""},{"location":"specification/error-handling/#_3","title":"\u901a\u7528\u9519\u8bef\u7801","text":"\u4ee3\u7801 \u540d\u79f0 \u542b\u4e49 \u5178\u578b\u89e6\u53d1\u573a\u666f 400 Bad Request \u65e0\u6548\u8bf7\u6c42\u683c\u5f0f \u6570\u636e\u7ed3\u6784\u6821\u9a8c\u5931\u8d25\u3001\u5b57\u6bb5\u7f3a\u5931\u6216\u7c7b\u578b\u9519\u8bef 401 Unauthorized \u672a\u6388\u6743 \u8ba4\u8bc1\u5931\u8d25\u3001Token \u65e0\u6548 403 Forbidden \u6743\u9650\u8fdd\u89c4 \u8de8\u623f\u95f4\u8bbf\u95ee\u3001Agent \u72ec\u5360\u51b2\u7a81\u3001\u672a\u6388\u6743\u64cd\u4f5c 404 Not Found \u8d44\u6e90\u4e0d\u5b58\u5728 \u5de5\u5177\u6216 Computer \u4e0d\u5b58\u5728\u3001MCP \u914d\u7f6e\u7f3a\u5931 408 Timeout \u8bf7\u6c42\u8d85\u65f6 \u5de5\u5177\u8c03\u7528\u8d85\u8fc7\u7ea6\u5b9a\u8d85\u65f6\u65f6\u95f4\u672a\u8fd4\u56de 500 Internal Error \u5185\u90e8\u9519\u8bef Server \u6216 Computer \u7aef\u903b\u8f91\u5f02\u5e38"},{"location":"specification/error-handling/#_4","title":"\u5de5\u5177\u8c03\u7528\u9519\u8bef\u7801","text":"\u4ee3\u7801 \u540d\u79f0 \u542b\u4e49 4001 Tool Not Found \u5de5\u5177\u4e0d\u5b58\u5728 4002 Tool Disabled \u5de5\u5177\u88ab\u7981\u7528 4003 Tool Execution Failed \u5de5\u5177\u6267\u884c\u5931\u8d25 4004 Tool Timeout \u5de5\u5177\u6267\u884c\u8d85\u65f6 4005 Tool Requires Confirmation \u5de5\u5177\u9700\u8981\u4e8c\u6b21\u786e\u8ba4"},{"location":"specification/error-handling/#_5","title":"\u623f\u95f4\u7ba1\u7406\u9519\u8bef\u7801","text":"\u4ee3\u7801 \u540d\u79f0 \u542b\u4e49 4101 Room Full \u623f\u95f4\u5df2\u6709 Agent 4102 Room Not Found \u623f\u95f4\u4e0d\u5b58\u5728 4103 Not In Room \u672a\u52a0\u5165\u623f\u95f4 4104 Cross Room Access \u8de8\u623f\u95f4\u8bbf\u95ee\u88ab\u62d2\u7edd"},{"location":"specification/error-handling/#_6","title":"\u9519\u8bef\u54cd\u5e94\u683c\u5f0f","text":""},{"location":"specification/error-handling/#_7","title":"\u6807\u51c6\u9519\u8bef\u54cd\u5e94","text":"<pre><code>{\n  \"error\": {\n    \"code\": 404,\n    \"message\": \"\u8bf7\u6c42\u7684\u5de5\u5177\u4e0d\u5b58\u5728\",\n    \"details\": {\n      \"tool_name\": \"invalid-tool-name\",\n      \"computer\": \"my-computer\"\n    }\n  }\n}\n</code></pre>"},{"location":"specification/error-handling/#_8","title":"\u5b57\u6bb5\u8bf4\u660e","text":"\u5b57\u6bb5 \u7c7b\u578b \u5fc5\u9700 \u8bf4\u660e <code>error.code</code> int \u662f \u9519\u8bef\u7801 <code>error.message</code> str \u662f \u4eba\u7c7b\u53ef\u8bfb\u7684\u9519\u8bef\u63cf\u8ff0 <code>error.details</code> object \u5426 \u7ed3\u6784\u5316\u8c03\u8bd5\u4fe1\u606f"},{"location":"specification/error-handling/#_9","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9879","text":"<p><code>details</code> \u5b57\u6bb5\u7981\u6b62\u5305\u542b\u4ee5\u4e0b\u654f\u611f\u4fe1\u606f\uff1a</p> <ul> <li>API \u5bc6\u94a5\u6216 Token</li> <li>\u5185\u90e8 IP \u5730\u5740\u6216\u7aef\u53e3</li> <li>\u6570\u636e\u5e93\u8fde\u63a5\u4fe1\u606f</li> <li>\u7528\u6237\u5bc6\u7801\u6216\u51ed\u8bc1</li> <li>\u5806\u6808\u8ddf\u8e2a\uff08\u751f\u4ea7\u73af\u5883\uff09</li> </ul>"},{"location":"specification/error-handling/#_10","title":"\u4e8b\u4ef6\u7ea7\u9519\u8bef\u5904\u7406","text":""},{"location":"specification/error-handling/#serverjoin_office","title":"server:join_office \u54cd\u5e94","text":"<pre><code># \u6210\u529f\n(True, None)\n\n# \u5931\u8d25\n(False, \"Room already has an agent\")\n</code></pre>"},{"location":"specification/error-handling/#clienttool_call","title":"client:tool_call \u54cd\u5e94","text":"<p>\u5de5\u5177\u8c03\u7528\u4f7f\u7528 MCP \u7684 <code>CallToolResult</code> \u7ed3\u6784\u8fd4\u56de\u7ed3\u679c\uff1a</p> <pre><code>class CallToolResult:\n    content: list[TextContent | ImageContent | EmbeddedResource]\n    isError: bool  # \u662f\u5426\u4e3a\u9519\u8bef\u7ed3\u679c\n    meta: dict     # \u5143\u6570\u636e\n</code></pre> <p>\u5f53 <code>isError=True</code> \u65f6\uff0c<code>content</code> \u4e2d\u5305\u542b\u9519\u8bef\u4fe1\u606f\u3002</p>"},{"location":"specification/error-handling/#_11","title":"\u8d85\u65f6\u5904\u7406","text":""},{"location":"specification/error-handling/#agent","title":"Agent \u7aef\u8d85\u65f6","text":"<p>Agent \u5728\u53d1\u8d77\u5de5\u5177\u8c03\u7528\u65f6\u6307\u5b9a <code>timeout</code>\uff1a</p> <pre><code>result = await agent.emit_tool_call(\n    computer=\"my-computer\",\n    tool_name=\"slow_tool\",\n    params={},\n    timeout=30  # 30 \u79d2\u8d85\u65f6\n)\n</code></pre> <p>\u8d85\u65f6\u540e\uff0cAgent \u5e94\uff1a</p> <ol> <li>\u53d1\u9001 <code>server:tool_call_cancel</code> \u53d6\u6d88\u8bf7\u6c42</li> <li>\u8fd4\u56de\u8d85\u65f6\u9519\u8bef\u7ed9\u8c03\u7528\u65b9</li> </ol> <pre><code># \u8d85\u65f6\u8fd4\u56de\u793a\u4f8b\nCallToolResult(\n    content=[TextContent(text=\"Tool call timeout\")],\n    isError=True,\n    meta={\"timeout\": True}\n)\n</code></pre>"},{"location":"specification/error-handling/#server","title":"Server \u7aef\u8d85\u65f6","text":"<p>Server \u5728\u8f6c\u53d1\u8bf7\u6c42\u65f6\u5e94\u8bbe\u7f6e\u5408\u7406\u7684\u8d85\u65f6\uff1a</p> <ul> <li>\u4f7f\u7528 Agent \u8bf7\u6c42\u4e2d\u7684 <code>timeout</code> \u503c</li> <li>\u6dfb\u52a0\u5c11\u91cf\u7f13\u51b2\u65f6\u95f4\uff08\u5982 5 \u79d2\uff09</li> </ul>"},{"location":"specification/error-handling/#computer","title":"Computer \u7aef\u8d85\u65f6","text":"<p>Computer \u5e94\u5728\u5de5\u5177\u6267\u884c\u8d85\u65f6\u65f6\uff1a</p> <ol> <li>\u5c1d\u8bd5\u4e2d\u65ad\u5de5\u5177\u6267\u884c</li> <li>\u8fd4\u56de\u8d85\u65f6\u9519\u8bef</li> </ol>"},{"location":"specification/error-handling/#_12","title":"\u91cd\u8bd5\u7b56\u7565","text":""},{"location":"specification/error-handling/#_13","title":"\u5efa\u8bae\u7684\u91cd\u8bd5\u7b56\u7565","text":"\u9519\u8bef\u7c7b\u578b \u662f\u5426\u91cd\u8bd5 \u7b56\u7565 400 Bad Request \u5426 \u4fee\u590d\u8bf7\u6c42\u540e\u91cd\u8bd5 401 Unauthorized \u5426 \u91cd\u65b0\u8ba4\u8bc1\u540e\u91cd\u8bd5 403 Forbidden \u5426 \u4e0d\u91cd\u8bd5 404 Not Found \u5426 \u4e0d\u91cd\u8bd5 408 Timeout \u53ef\u9009 \u6307\u6570\u9000\u907f\u91cd\u8bd5 500 Internal Error \u53ef\u9009 \u6307\u6570\u9000\u907f\u91cd\u8bd5"},{"location":"specification/error-handling/#_14","title":"\u6307\u6570\u9000\u907f\u793a\u4f8b","text":"<pre><code>async def retry_with_backoff(func, max_retries=3):\n    for i in range(max_retries):\n        try:\n            return await func()\n        except TimeoutError:\n            if i == max_retries - 1:\n                raise\n            wait_time = (2 ** i) + random.uniform(0, 1)\n            await asyncio.sleep(wait_time)\n</code></pre>"},{"location":"specification/error-handling/#_15","title":"\u9519\u8bef\u4f20\u64ad","text":""},{"location":"specification/error-handling/#_16","title":"\u5de5\u5177\u8c03\u7528\u9519\u8bef\u4f20\u64ad\u94fe","text":"<pre><code>MCP Server \u2192 Computer \u2192 Server \u2192 Agent\n     \u2502           \u2502          \u2502        \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                \u9519\u8bef\u4fe1\u606f\u4fdd\u7559\n</code></pre> <p>\u6bcf\u4e00\u5c42\u5e94\uff1a</p> <ol> <li>\u8bb0\u5f55\u9519\u8bef\u65e5\u5fd7</li> <li>\u5c06\u9519\u8bef\u4fe1\u606f\u5411\u4e0a\u4f20\u64ad</li> <li>\u4e0d\u4e22\u5931\u539f\u59cb\u9519\u8bef\u7ec6\u8282</li> </ol>"},{"location":"specification/error-handling/#_17","title":"\u65e5\u5fd7\u8bb0\u5f55\u5efa\u8bae","text":"<pre><code># \u63a8\u8350\u7684\u65e5\u5fd7\u683c\u5f0f\nlogger.error(\n    \"Tool call failed\",\n    extra={\n        \"req_id\": req_id,\n        \"tool_name\": tool_name,\n        \"computer\": computer,\n        \"error_code\": error.code,\n        \"error_message\": error.message\n    }\n)\n</code></pre>"},{"location":"specification/error-handling/#todo","title":"TODO","text":"<p>\u4ee5\u4e0b\u529f\u80fd\u5c1a\u672a\u5b9e\u73b0\uff0c\u8ba1\u5212\u5728\u540e\u7eed\u7248\u672c\u4e2d\u5b8c\u5584\uff1a</p> <ul> <li> \u7edf\u4e00\u7684\u9519\u8bef\u7801\u5b9a\u4e49\u6587\u4ef6</li> <li> \u9519\u8bef\u7801\u56fd\u9645\u5316\u652f\u6301</li> <li> \u9519\u8bef\u8ffd\u8e2a ID\uff08trace_id\uff09</li> <li> \u9519\u8bef\u7edf\u8ba1\u548c\u76d1\u63a7\u63a5\u53e3</li> </ul>"},{"location":"specification/error-handling/#_18","title":"\u53c2\u8003","text":"<ul> <li>MCP CallToolResult: https://github.com/modelcontextprotocol/specification</li> <li>Socket.IO \u9519\u8bef\u5904\u7406: https://socket.io/docs/v4/handling-errors/</li> </ul>"},{"location":"specification/events/","title":"A2C-SMCP \u4e8b\u4ef6\u5b9a\u4e49","text":"<p>\u672c\u6587\u6863\u5b9a\u4e49\u4e86 A2C-SMCP \u534f\u8bae\u7684\u6240\u6709\u4e8b\u4ef6\uff0c\u57fa\u4e8e <code>a2c_smcp/smcp.py</code> \u4e2d\u7684\u5b9e\u9645\u5b9e\u73b0\u3002</p>"},{"location":"specification/events/#_1","title":"\u547d\u540d\u7a7a\u95f4","text":"<p>\u6240\u6709\u4e8b\u4ef6\u5728\u4ee5\u4e0b\u547d\u540d\u7a7a\u95f4\u4e2d\u4f20\u8f93\uff1a</p> <pre><code>SMCP_NAMESPACE = \"/smcp\"\n</code></pre>"},{"location":"specification/events/#_2","title":"\u4e8b\u4ef6\u5206\u7c7b\u89c4\u5219","text":"\u524d\u7f00 \u65b9\u5411 \u8bf4\u660e \u5b9e\u73b0\u8981\u6c42 <code>client:</code> Agent \u2192 Server \u2192 Computer \u5de5\u5177\u64cd\u4f5c\u7c7b\uff0c\u7531 Server \u8def\u7531\u5230\u6307\u5b9a Computer Computer \u5fc5\u987b\u5b9e\u73b0 <code>server:</code> \u5ba2\u6237\u7aef \u2192 Server \u623f\u95f4\u7ba1\u7406\u3001\u72b6\u6001\u66f4\u65b0\u7c7b Server \u5fc5\u987b\u5b9e\u73b0 <code>notify:</code> Server \u2192 \u5e7f\u64ad \u901a\u77e5\u7c7b\uff0c\u7531 Server \u5e7f\u64ad\u5230\u623f\u95f4 Agent/Computer \u9009\u62e9\u6027\u63a5\u6536"},{"location":"specification/events/#_3","title":"\u5b8c\u6574\u4e8b\u4ef6\u5217\u8868","text":""},{"location":"specification/events/#client-agent-computer","title":"Client \u4e8b\u4ef6\uff08Agent \u2192 Computer\uff09","text":"<p>\u8fd9\u4e9b\u4e8b\u4ef6\u7531 Agent \u53d1\u8d77\uff0c\u901a\u8fc7 Server \u8def\u7531\u5230\u6307\u5b9a\u7684 Computer \u6267\u884c\u3002</p> \u4e8b\u4ef6\u5e38\u91cf \u4e8b\u4ef6\u540d\u79f0 \u63cf\u8ff0 \u8bf7\u6c42\u6570\u636e\u7ed3\u6784 \u54cd\u5e94\u6570\u636e\u7ed3\u6784 <code>TOOL_CALL_EVENT</code> <code>client:tool_call</code> \u5de5\u5177\u8c03\u7528\u8bf7\u6c42 <code>ToolCallReq</code> <code>CallToolResult</code> <code>GET_CONFIG_EVENT</code> <code>client:get_config</code> \u83b7\u53d6 Computer \u914d\u7f6e <code>GetComputerConfigReq</code> <code>GetComputerConfigRet</code> <code>GET_TOOLS_EVENT</code> <code>client:get_tools</code> \u83b7\u53d6\u5de5\u5177\u5217\u8868 <code>GetToolsReq</code> <code>GetToolsRet</code> <code>GET_DESKTOP_EVENT</code> <code>client:get_desktop</code> \u83b7\u53d6\u684c\u9762\u4fe1\u606f <code>GetDeskTopReq</code> <code>GetDeskTopRet</code>"},{"location":"specification/events/#server-server","title":"Server \u4e8b\u4ef6\uff08\u5ba2\u6237\u7aef \u2192 Server\uff09","text":"<p>\u8fd9\u4e9b\u4e8b\u4ef6\u7531 Agent \u6216 Computer \u53d1\u8d77\uff0c\u7531 Server \u5904\u7406\u3002</p> \u4e8b\u4ef6\u5e38\u91cf \u4e8b\u4ef6\u540d\u79f0 \u53d1\u8d77\u65b9 \u63cf\u8ff0 \u6570\u636e\u7ed3\u6784 <code>JOIN_OFFICE_EVENT</code> <code>server:join_office</code> Agent/Computer \u52a0\u5165\u623f\u95f4 <code>EnterOfficeReq</code> <code>LEAVE_OFFICE_EVENT</code> <code>server:leave_office</code> Agent/Computer \u79bb\u5f00\u623f\u95f4 <code>LeaveOfficeReq</code> <code>UPDATE_CONFIG_EVENT</code> <code>server:update_config</code> Computer \u914d\u7f6e\u66f4\u65b0\u901a\u77e5\u8bf7\u6c42 <code>UpdateComputerConfigReq</code> <code>UPDATE_TOOL_LIST_EVENT</code> <code>server:update_tool_list</code> Computer \u5de5\u5177\u5217\u8868\u66f4\u65b0\u901a\u77e5\u8bf7\u6c42 <code>UpdateToolListNotification</code> <code>UPDATE_DESKTOP_EVENT</code> <code>server:update_desktop</code> Computer \u684c\u9762\u66f4\u65b0\u901a\u77e5\u8bf7\u6c42 (\u5f85\u5b9a\u4e49) <code>CANCEL_TOOL_CALL_EVENT</code> <code>server:tool_call_cancel</code> Agent \u53d6\u6d88\u5de5\u5177\u8c03\u7528 <code>AgentCallData</code> <code>LIST_ROOM_EVENT</code> <code>server:list_room</code> Agent \u5217\u51fa\u623f\u95f4\u5185\u6240\u6709\u4f1a\u8bdd <code>ListRoomReq</code>"},{"location":"specification/events/#notify-server","title":"Notify \u4e8b\u4ef6\uff08Server \u2192 \u5e7f\u64ad\uff09","text":"<p>\u8fd9\u4e9b\u4e8b\u4ef6\u7531 Server \u5e7f\u64ad\u5230\u623f\u95f4\u5185\u7684\u6240\u6709\u6210\u5458\u3002</p> \u4e8b\u4ef6\u5e38\u91cf \u4e8b\u4ef6\u540d\u79f0 \u63cf\u8ff0 \u6570\u636e\u7ed3\u6784 <code>ENTER_OFFICE_NOTIFICATION</code> <code>notify:enter_office</code> \u6210\u5458\u52a0\u5165\u623f\u95f4\u901a\u77e5 <code>EnterOfficeNotification</code> <code>LEAVE_OFFICE_NOTIFICATION</code> <code>notify:leave_office</code> \u6210\u5458\u79bb\u5f00\u623f\u95f4\u901a\u77e5 <code>LeaveOfficeNotification</code> <code>UPDATE_CONFIG_NOTIFICATION</code> <code>notify:update_config</code> \u914d\u7f6e\u66f4\u65b0\u901a\u77e5 <code>UpdateMCPConfigNotification</code> <code>UPDATE_TOOL_LIST_NOTIFICATION</code> <code>notify:update_tool_list</code> \u5de5\u5177\u5217\u8868\u66f4\u65b0\u901a\u77e5 <code>UpdateToolListNotification</code> <code>UPDATE_DESKTOP_NOTIFICATION</code> <code>notify:update_desktop</code> \u684c\u9762\u66f4\u65b0\u901a\u77e5 (\u5f85\u5b9a\u4e49) <code>CANCEL_TOOL_CALL_NOTIFICATION</code> <code>notify:tool_call_cancel</code> \u5de5\u5177\u8c03\u7528\u53d6\u6d88\u901a\u77e5 <code>AgentCallData</code>"},{"location":"specification/events/#_4","title":"\u4e8b\u4ef6\u8be6\u7ec6\u8bf4\u660e","text":""},{"location":"specification/events/#_5","title":"\u5de5\u5177\u8c03\u7528\u4e8b\u4ef6","text":""},{"location":"specification/events/#clienttool_call","title":"<code>client:tool_call</code>","text":"<p>Agent \u5411\u6307\u5b9a Computer \u53d1\u8d77\u5de5\u5177\u8c03\u7528\u3002</p> <p>\u8bf7\u6c42\u6d41\u7a0b: <pre><code>Agent \u2500\u2500[client:tool_call]\u2500\u2500\u2192 Server \u2500\u2500[\u8f6c\u53d1]\u2500\u2500\u2192 Computer\n                                                    \u2502\nAgent \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 \u8fd4\u56de\u7ed3\u679c\n</code></pre></p> <p>\u8bf7\u6c42\u6570\u636e (ToolCallReq): <pre><code>{\n    \"agent\": str,       # Agent \u6807\u8bc6\n    \"req_id\": str,      # \u8bf7\u6c42 ID\uff08\u7528\u4e8e\u53bb\u91cd\u548c\u53d6\u6d88\uff09\n    \"computer\": str,    # \u76ee\u6807 Computer \u540d\u79f0\n    \"tool_name\": str,   # \u5de5\u5177\u540d\u79f0\n    \"params\": dict,     # \u5de5\u5177\u8c03\u7528\u53c2\u6570\n    \"timeout\": int      # \u8d85\u65f6\u65f6\u95f4\uff08\u79d2\uff09\n}\n</code></pre></p> <p>\u54cd\u5e94: \u8fd4\u56de MCP <code>CallToolResult</code> \u7ed3\u6784\u3002</p>"},{"location":"specification/events/#clientget_tools","title":"<code>client:get_tools</code>","text":"<p>\u83b7\u53d6\u6307\u5b9a Computer \u7684\u53ef\u7528\u5de5\u5177\u5217\u8868\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (GetToolsReq): <pre><code>{\n    \"agent\": str,       # Agent \u6807\u8bc6\n    \"req_id\": str,      # \u8bf7\u6c42 ID\n    \"computer\": str     # \u76ee\u6807 Computer \u540d\u79f0\n}\n</code></pre></p> <p>\u54cd\u5e94\u6570\u636e (GetToolsRet): <pre><code>{\n    \"tools\": list[SMCPTool],  # \u5de5\u5177\u5217\u8868\n    \"req_id\": str             # \u8bf7\u6c42 ID\n}\n</code></pre></p>"},{"location":"specification/events/#clientget_desktop","title":"<code>client:get_desktop</code>","text":"<p>\u83b7\u53d6\u6307\u5b9a Computer \u7684\u684c\u9762\u4fe1\u606f\uff08\u7a97\u53e3\u8d44\u6e90\u805a\u5408\u89c6\u56fe\uff09\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (GetDeskTopReq): <pre><code>{\n    \"agent\": str,           # Agent \u6807\u8bc6\n    \"req_id\": str,          # \u8bf7\u6c42 ID\n    \"computer\": str,        # \u76ee\u6807 Computer \u540d\u79f0\n    \"desktop_size\": int,    # \u53ef\u9009\uff1a\u9650\u5236\u8fd4\u56de\u7684\u684c\u9762\u5185\u5bb9\u6570\u91cf\n    \"window\": str           # \u53ef\u9009\uff1a\u6307\u5b9a\u83b7\u53d6\u7684 WindowURI\n}\n</code></pre></p> <p>\u54cd\u5e94\u6570\u636e (GetDeskTopRet): <pre><code>{\n    \"desktops\": list[str],  # \u684c\u9762\u5185\u5bb9\u5217\u8868\n    \"req_id\": str           # \u8bf7\u6c42 ID\n}\n</code></pre></p>"},{"location":"specification/events/#clientget_config","title":"<code>client:get_config</code>","text":"<p>\u83b7\u53d6\u6307\u5b9a Computer \u7684\u5b8c\u6574\u914d\u7f6e\u4fe1\u606f\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (GetComputerConfigReq): <pre><code>{\n    \"agent\": str,       # Agent \u6807\u8bc6\n    \"req_id\": str,      # \u8bf7\u6c42 ID\n    \"computer\": str     # \u76ee\u6807 Computer \u540d\u79f0\n}\n</code></pre></p> <p>\u54cd\u5e94\u6570\u636e (GetComputerConfigRet): <pre><code>{\n    \"inputs\": list[MCPServerInput] | None,  # \u8f93\u5165\u5b9a\u4e49\u5217\u8868\n    \"servers\": dict[str, MCPServerConfig]   # MCP Server \u914d\u7f6e\u6620\u5c04\n}\n</code></pre></p>"},{"location":"specification/events/#_6","title":"\u623f\u95f4\u7ba1\u7406\u4e8b\u4ef6","text":""},{"location":"specification/events/#serverjoin_office","title":"<code>server:join_office</code>","text":"<p>Agent \u6216 Computer \u8bf7\u6c42\u52a0\u5165\u623f\u95f4\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (EnterOfficeReq): <pre><code>{\n    \"role\": Literal[\"computer\", \"agent\"],  # \u89d2\u8272\u7c7b\u578b\n    \"name\": str,                           # \u540d\u79f0\n    \"office_id\": str                       # \u623f\u95f4 ID\n}\n</code></pre></p> <p>\u54cd\u5e94: <code>(bool, str | None)</code> - \u6210\u529f\u6807\u5fd7\u548c\u9519\u8bef\u4fe1\u606f\u3002</p> <p>Server \u5904\u7406\u89c4\u5219: - Agent: \u68c0\u67e5\u623f\u95f4\u662f\u5426\u5df2\u6709\u5176\u4ed6 Agent\uff0c\u82e5\u6709\u5219\u62d2\u7edd - Computer: \u82e5\u5df2\u5728\u5176\u4ed6\u623f\u95f4\uff0c\u81ea\u52a8\u79bb\u5f00\u65e7\u623f\u95f4</p>"},{"location":"specification/events/#serverleave_office","title":"<code>server:leave_office</code>","text":"<p>Agent \u6216 Computer \u8bf7\u6c42\u79bb\u5f00\u623f\u95f4\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (LeaveOfficeReq): <pre><code>{\n    \"office_id\": str    # \u623f\u95f4 ID\n}\n</code></pre></p>"},{"location":"specification/events/#serverlist_room","title":"<code>server:list_room</code>","text":"<p>Agent \u67e5\u8be2\u6307\u5b9a\u623f\u95f4\u5185\u7684\u6240\u6709\u4f1a\u8bdd\u4fe1\u606f\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (ListRoomReq): <pre><code>{\n    \"agent\": str,       # Agent \u6807\u8bc6\n    \"req_id\": str,      # \u8bf7\u6c42 ID\n    \"office_id\": str    # \u623f\u95f4 ID\n}\n</code></pre></p> <p>\u54cd\u5e94\u6570\u636e (ListRoomRet): <pre><code>{\n    \"sessions\": list[SessionInfo],  # \u4f1a\u8bdd\u5217\u8868\n    \"req_id\": str                   # \u8bf7\u6c42 ID\n}\n</code></pre></p> <p>\u5176\u4e2d <code>SessionInfo</code>: <pre><code>{\n    \"sid\": str,                             # \u4f1a\u8bdd ID\n    \"name\": str,                            # \u4f1a\u8bdd\u540d\u79f0\n    \"role\": Literal[\"computer\", \"agent\"],   # \u89d2\u8272\n    \"office_id\": str                        # \u6240\u5c5e\u623f\u95f4 ID\n}\n</code></pre></p>"},{"location":"specification/events/#_7","title":"\u914d\u7f6e\u4e0e\u72b6\u6001\u66f4\u65b0\u4e8b\u4ef6","text":""},{"location":"specification/events/#serverupdate_config","title":"<code>server:update_config</code>","text":"<p>Computer \u901a\u77e5 Server \u5176\u914d\u7f6e\u5df2\u66f4\u65b0\uff0cServer \u968f\u540e\u5e7f\u64ad <code>notify:update_config</code>\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (UpdateComputerConfigReq): <pre><code>{\n    \"computer\": str     # Computer \u540d\u79f0\n}\n</code></pre></p>"},{"location":"specification/events/#serverupdate_tool_list","title":"<code>server:update_tool_list</code>","text":"<p>Computer \u901a\u77e5 Server \u5176\u5de5\u5177\u5217\u8868\u5df2\u66f4\u65b0\uff0cServer \u968f\u540e\u5e7f\u64ad <code>notify:update_tool_list</code>\u3002</p> <p>\u8bf7\u6c42\u6570\u636e (UpdateToolListNotification): <pre><code>{\n    \"computer\": str     # Computer \u540d\u79f0\n}\n</code></pre></p>"},{"location":"specification/events/#serverupdate_desktop","title":"<code>server:update_desktop</code>","text":"<p>Computer \u901a\u77e5 Server \u5176\u684c\u9762\u5185\u5bb9\u5df2\u66f4\u65b0\uff0cServer \u968f\u540e\u5e7f\u64ad <code>notify:update_desktop</code>\u3002</p>"},{"location":"specification/events/#_8","title":"\u901a\u77e5\u4e8b\u4ef6","text":""},{"location":"specification/events/#notifyenter_office","title":"<code>notify:enter_office</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u6709\u6210\u5458\u52a0\u5165\u623f\u95f4\u3002</p> <p>\u6570\u636e\u7ed3\u6784 (EnterOfficeNotification): <pre><code>{\n    \"office_id\": str,\n    \"computer\": str | None,  # \u52a0\u5165\u7684 Computer \u540d\u79f0\uff08\u82e5\u4e3a Computer\uff09\n    \"agent\": str | None      # \u52a0\u5165\u7684 Agent \u540d\u79f0\uff08\u82e5\u4e3a Agent\uff09\n}\n</code></pre></p> <p>Agent \u54cd\u5e94\u5efa\u8bae: \u6536\u5230\u6b64\u901a\u77e5\u540e\uff0c\u5e94\u81ea\u52a8\u8c03\u7528 <code>client:get_tools</code> \u83b7\u53d6\u65b0 Computer \u7684\u5de5\u5177\u5217\u8868\u3002</p>"},{"location":"specification/events/#notifyleave_office","title":"<code>notify:leave_office</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u6709\u6210\u5458\u79bb\u5f00\u623f\u95f4\u3002</p> <p>\u6570\u636e\u7ed3\u6784 (LeaveOfficeNotification): <pre><code>{\n    \"office_id\": str,\n    \"computer\": str | None,  # \u79bb\u5f00\u7684 Computer \u540d\u79f0\n    \"agent\": str | None      # \u79bb\u5f00\u7684 Agent \u540d\u79f0\n}\n</code></pre></p>"},{"location":"specification/events/#notifyupdate_config","title":"<code>notify:update_config</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u67d0 Computer \u7684\u914d\u7f6e\u5df2\u66f4\u65b0\u3002</p> <p>\u6570\u636e\u7ed3\u6784 (UpdateMCPConfigNotification): <pre><code>{\n    \"computer\": str     # \u66f4\u65b0\u914d\u7f6e\u7684 Computer \u540d\u79f0\n}\n</code></pre></p> <p>Agent \u54cd\u5e94\u5efa\u8bae: \u6536\u5230\u6b64\u901a\u77e5\u540e\uff0c\u53ef\u8c03\u7528 <code>client:get_config</code> \u83b7\u53d6\u6700\u65b0\u914d\u7f6e\u3002</p>"},{"location":"specification/events/#notifyupdate_tool_list","title":"<code>notify:update_tool_list</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u67d0 Computer \u7684\u5de5\u5177\u5217\u8868\u5df2\u66f4\u65b0\u3002</p> <p>\u6570\u636e\u7ed3\u6784 (UpdateToolListNotification): <pre><code>{\n    \"computer\": str     # \u66f4\u65b0\u5de5\u5177\u5217\u8868\u7684 Computer \u540d\u79f0\n}\n</code></pre></p> <p>Agent \u54cd\u5e94\u5efa\u8bae: \u6536\u5230\u6b64\u901a\u77e5\u540e\uff0c\u5e94\u8c03\u7528 <code>client:get_tools</code> \u5237\u65b0\u672c\u5730\u5de5\u5177\u5217\u8868\u3002</p>"},{"location":"specification/events/#notifyupdate_desktop","title":"<code>notify:update_desktop</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u67d0 Computer \u7684\u684c\u9762\u5185\u5bb9\u5df2\u66f4\u65b0\u3002</p> <p>Agent \u54cd\u5e94\u5efa\u8bae: \u6536\u5230\u6b64\u901a\u77e5\u540e\uff0c\u53ef\u6309\u9700\u8c03\u7528 <code>client:get_desktop</code> \u83b7\u53d6\u6700\u65b0\u684c\u9762\u3002</p>"},{"location":"specification/events/#notifytool_call_cancel","title":"<code>notify:tool_call_cancel</code>","text":"<p>Server \u5e7f\u64ad\uff1a\u67d0\u5de5\u5177\u8c03\u7528\u5df2\u88ab\u53d6\u6d88\u3002</p> <p>\u6570\u636e\u7ed3\u6784 (AgentCallData): <pre><code>{\n    \"agent\": str,   # \u53d1\u8d77\u53d6\u6d88\u7684 Agent\n    \"req_id\": str   # \u88ab\u53d6\u6d88\u7684\u8bf7\u6c42 ID\n}\n</code></pre></p>"},{"location":"specification/events/#_9","title":"\u4e8b\u4ef6\u6d41\u7a0b\u56fe","text":""},{"location":"specification/events/#_10","title":"\u5de5\u5177\u8c03\u7528\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    participant A as Agent\n    participant S as Server\n    participant C as Computer\n\n    A-&gt;&gt;S: client:tool_call (ToolCallReq)\n    S-&gt;&gt;C: client:tool_call (\u8f6c\u53d1)\n    C-&gt;&gt;S: \u5de5\u5177\u6267\u884c\u7ed3\u679c\n    S-&gt;&gt;A: \u8fd4\u56de\u7ed3\u679c\n</code></pre>"},{"location":"specification/events/#_11","title":"\u52a8\u6001\u5de5\u5177\u53d1\u73b0\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    participant A as Agent\n    participant S as Server\n    participant C as Computer\n\n    Note over C: Computer \u52a0\u5165\u623f\u95f4\n    C-&gt;&gt;S: server:join_office\n    S-&gt;&gt;A: notify:enter_office\n    A-&gt;&gt;S: client:get_tools\n    S-&gt;&gt;C: client:get_tools (\u8f6c\u53d1)\n    C-&gt;&gt;S: \u5de5\u5177\u5217\u8868\n    S-&gt;&gt;A: GetToolsRet\n    Note over A: \u6ce8\u518c\u65b0\u5de5\u5177\n</code></pre>"},{"location":"specification/events/#_12","title":"\u914d\u7f6e\u66f4\u65b0\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    participant A as Agent\n    participant S as Server\n    participant C as Computer\n\n    Note over C: \u914d\u7f6e\u53d8\u66f4\n    C-&gt;&gt;S: server:update_config\n    S-&gt;&gt;A: notify:update_config\n    A-&gt;&gt;S: client:get_tools (\u53ef\u9009)\n    S-&gt;&gt;C: \u8f6c\u53d1\n    C-&gt;&gt;S: \u5de5\u5177\u5217\u8868\n    S-&gt;&gt;A: GetToolsRet\n</code></pre>"},{"location":"specification/events/#_13","title":"\u5b9e\u73b0\u8981\u6c42","text":""},{"location":"specification/events/#server","title":"Server \u5fc5\u987b\u5b9e\u73b0","text":"<ul> <li>\u6240\u6709 <code>server:*</code> \u4e8b\u4ef6\u7684\u5904\u7406</li> <li>\u6240\u6709 <code>client:*</code> \u4e8b\u4ef6\u7684\u8def\u7531\u8f6c\u53d1</li> <li>\u6240\u6709 <code>notify:*</code> \u4e8b\u4ef6\u7684\u5e7f\u64ad</li> </ul>"},{"location":"specification/events/#computer","title":"Computer \u5fc5\u987b\u5b9e\u73b0","text":"<ul> <li>\u6240\u6709 <code>client:*</code> \u4e8b\u4ef6\u7684\u5904\u7406\uff08\u4f5c\u4e3a\u63a5\u6536\u65b9\uff09</li> <li>\u623f\u95f4\u7ba1\u7406\u4e8b\u4ef6 (<code>server:join_office</code>, <code>server:leave_office</code>)</li> </ul>"},{"location":"specification/events/#agent","title":"Agent \u5e94\u8be5\u5b9e\u73b0","text":"<ul> <li><code>notify:enter_office</code> - \u81ea\u52a8\u83b7\u53d6\u65b0 Computer \u7684\u5de5\u5177</li> <li><code>notify:leave_office</code> - \u6e05\u7406\u79bb\u5f00 Computer \u7684\u5de5\u5177</li> <li><code>notify:update_config</code> / <code>notify:update_tool_list</code> - \u5237\u65b0\u5de5\u5177\u5217\u8868</li> </ul>"},{"location":"specification/events/#_14","title":"\u53c2\u8003","text":"<ul> <li>\u4e8b\u4ef6\u5e38\u91cf\u5b9a\u4e49: <code>a2c_smcp/smcp.py</code></li> <li>Server \u5b9e\u73b0: <code>a2c_smcp/server/namespace.py</code></li> <li>Agent \u5ba2\u6237\u7aef: <code>a2c_smcp/agent/client.py</code></li> <li>Computer \u5ba2\u6237\u7aef: <code>a2c_smcp/computer/socketio/client.py</code></li> </ul>"},{"location":"specification/room-model/","title":"A2C-SMCP \u623f\u95f4\u9694\u79bb\u6a21\u578b","text":"<p>\u672c\u6587\u6863\u8be6\u7ec6\u63cf\u8ff0 A2C-SMCP \u534f\u8bae\u7684\u623f\u95f4\uff08Office/Room\uff09\u9694\u79bb\u673a\u5236\u3002</p>"},{"location":"specification/room-model/#_1","title":"\u6982\u8ff0","text":"<p>\u623f\u95f4\u662f A2C-SMCP \u534f\u8bae\u4e2d\u7684\u903b\u8f91\u9694\u79bb\u5355\u5143\uff0c\u7528\u4e8e\u7ea6\u675f Agent \u4e0e Computer \u7684\u534f\u4f5c\u8303\u56f4\u3002\u623f\u95f4\u673a\u5236\u786e\u4fdd\uff1a</p> <ul> <li>\u5b89\u5168\u9694\u79bb: \u4e0d\u540c\u623f\u95f4\u7684\u6210\u5458\u65e0\u6cd5\u76f8\u4e92\u8bbf\u95ee</li> <li>\u8d44\u6e90\u8fb9\u754c: \u5de5\u5177\u8c03\u7528\u53ea\u80fd\u5728\u540c\u4e00\u623f\u95f4\u5185\u8fdb\u884c</li> <li>\u6d88\u606f\u9694\u79bb: \u901a\u77e5\u53ea\u5e7f\u64ad\u7ed9\u540c\u4e00\u623f\u95f4\u7684\u6210\u5458</li> </ul>"},{"location":"specification/room-model/#_2","title":"\u623f\u95f4\u6807\u8bc6","text":"<p>\u6bcf\u4e2a\u623f\u95f4\u901a\u8fc7 <code>office_id</code> \u552f\u4e00\u6807\u8bc6\uff1a</p> <pre><code>office_id: str  # \u623f\u95f4\u552f\u4e00\u6807\u8bc6\u7b26\n</code></pre> <p>\u547d\u540d\u5efa\u8bae: - \u4f7f\u7528 UUID \u6216\u4e1a\u52a1\u76f8\u5173\u7684\u552f\u4e00\u6807\u8bc6 - \u907f\u514d\u4f7f\u7528\u53ef\u9884\u6d4b\u7684\u5e8f\u5217\u53f7 - \u8003\u8651\u5305\u542b\u73af\u5883\u6807\u8bc6\uff08\u5982 <code>prod-</code>, <code>test-</code>\uff09</p>"},{"location":"specification/room-model/#_3","title":"\u623f\u95f4\u6210\u5458","text":""},{"location":"specification/room-model/#_4","title":"\u6210\u5458\u7c7b\u578b","text":"\u6210\u5458\u7c7b\u578b \u6570\u91cf\u9650\u5236 \u8bf4\u660e Agent \u6bcf\u4e2a\u623f\u95f4\u6700\u591a 1 \u4e2a \u5de5\u5177\u8c03\u7528\u53d1\u8d77\u65b9 Computer \u65e0\u9650\u5236 \u5de5\u5177\u63d0\u4f9b\u65b9"},{"location":"specification/room-model/#_5","title":"\u6210\u5458\u72b6\u6001","text":"<p>\u6bcf\u4e2a\u6210\u5458\u5728\u623f\u95f4\u4e2d\u7ef4\u62a4\u4ee5\u4e0b\u72b6\u6001\uff1a</p> <pre><code>class Session:\n    sid: str                    # Socket.IO \u4f1a\u8bdd ID\n    name: str                   # \u6210\u5458\u540d\u79f0\n    role: Literal[\"agent\", \"computer\"]  # \u89d2\u8272\n    office_id: str | None       # \u5f53\u524d\u6240\u5728\u623f\u95f4\n</code></pre>"},{"location":"specification/room-model/#_6","title":"\u52a0\u5165\u623f\u95f4","text":""},{"location":"specification/room-model/#_7","title":"\u52a0\u5165\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    participant C as Client (Agent/Computer)\n    participant S as Server\n    participant R as Room\n\n    C-&gt;&gt;S: server:join_office (EnterOfficeReq)\n    S-&gt;&gt;S: \u9a8c\u8bc1\u8bf7\u6c42\n    alt \u9a8c\u8bc1\u901a\u8fc7\n        S-&gt;&gt;R: \u52a0\u5165\u623f\u95f4\n        S-&gt;&gt;C: \u8fd4\u56de\u6210\u529f\n        S-&gt;&gt;R: notify:enter_office (\u5e7f\u64ad)\n    else \u9a8c\u8bc1\u5931\u8d25\n        S-&gt;&gt;C: \u8fd4\u56de\u9519\u8bef\n    end\n</code></pre>"},{"location":"specification/room-model/#_8","title":"\u8bf7\u6c42\u6570\u636e","text":"<pre><code>class EnterOfficeReq(TypedDict):\n    role: Literal[\"computer\", \"agent\"]  # \u89d2\u8272\n    name: str                           # \u540d\u79f0\n    office_id: str                      # \u76ee\u6807\u623f\u95f4 ID\n</code></pre>"},{"location":"specification/room-model/#_9","title":"\u9a8c\u8bc1\u89c4\u5219","text":""},{"location":"specification/room-model/#agent","title":"Agent \u52a0\u5165\u89c4\u5219","text":"<ol> <li>\u68c0\u67e5\u623f\u95f4\u662f\u5426\u5df2\u6709 Agent</li> <li>\u82e5\u5df2\u6709 Agent\uff0c\u62d2\u7edd\u52a0\u5165\uff08\u8fd4\u56de\u9519\u8bef\uff09</li> <li>\u82e5\u623f\u95f4\u4e3a\u7a7a\u6216\u53ea\u6709 Computer\uff0c\u5141\u8bb8\u52a0\u5165</li> </ol> <pre><code># Server \u7aef\u9a8c\u8bc1\u903b\u8f91\uff08\u4f2a\u4ee3\u7801\uff09\nif role == \"agent\":\n    existing_agent = get_agent_in_room(office_id)\n    if existing_agent and existing_agent.sid != sid:\n        return False, \"Room already has an agent\"\n    return True, None\n</code></pre>"},{"location":"specification/room-model/#computer","title":"Computer \u52a0\u5165\u89c4\u5219","text":"<ol> <li>\u68c0\u67e5 Computer \u662f\u5426\u5df2\u5728\u5176\u4ed6\u623f\u95f4</li> <li>\u82e5\u5728\u5176\u4ed6\u623f\u95f4\uff0c\u5148\u81ea\u52a8\u79bb\u5f00\u65e7\u623f\u95f4</li> <li>\u52a0\u5165\u65b0\u623f\u95f4</li> </ol> <pre><code># Server \u7aef\u5904\u7406\u903b\u8f91\uff08\u4f2a\u4ee3\u7801\uff09\nif role == \"computer\":\n    current_room = get_current_room(sid)\n    if current_room and current_room != office_id:\n        await leave_room(sid, current_room)\n    await join_room(sid, office_id)\n</code></pre>"},{"location":"specification/room-model/#_10","title":"\u79bb\u5f00\u623f\u95f4","text":""},{"location":"specification/room-model/#_11","title":"\u79bb\u5f00\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    participant C as Client\n    participant S as Server\n    participant R as Room\n\n    C-&gt;&gt;S: server:leave_office (LeaveOfficeReq)\n    S-&gt;&gt;R: notify:leave_office (\u5e7f\u64ad\uff0c\u79bb\u5f00\u524d)\n    S-&gt;&gt;R: \u79fb\u9664\u6210\u5458\n    S-&gt;&gt;C: \u8fd4\u56de\u6210\u529f\n</code></pre>"},{"location":"specification/room-model/#_12","title":"\u8bf7\u6c42\u6570\u636e","text":"<pre><code>class LeaveOfficeReq(TypedDict):\n    office_id: str  # \u8981\u79bb\u5f00\u7684\u623f\u95f4 ID\n</code></pre>"},{"location":"specification/room-model/#_13","title":"\u81ea\u52a8\u79bb\u5f00\u573a\u666f","text":"<p>\u4ee5\u4e0b\u573a\u666f\u4f1a\u89e6\u53d1\u81ea\u52a8\u79bb\u5f00\uff1a</p> <ol> <li>\u8fde\u63a5\u65ad\u5f00: Socket.IO \u8fde\u63a5\u65ad\u5f00\u65f6</li> <li>\u623f\u95f4\u5207\u6362: Computer \u52a0\u5165\u65b0\u623f\u95f4\u65f6\uff08\u81ea\u52a8\u79bb\u5f00\u65e7\u623f\u95f4\uff09</li> <li>\u670d\u52a1\u5668\u5173\u95ed: Server \u5173\u95ed\u65f6</li> </ol>"},{"location":"specification/room-model/#_14","title":"\u9694\u79bb\u4fdd\u969c","text":""},{"location":"specification/room-model/#_15","title":"\u9694\u79bb\u7ea6\u675f\u8868","text":"\u7ea6\u675f\u7c7b\u578b \u89e6\u53d1\u6761\u4ef6 Server \u884c\u4e3a Agent \u72ec\u5360 \u623f\u95f4\u5df2\u6709 Agent\uff0c\u65b0 Agent \u5c1d\u8bd5\u52a0\u5165 \u62d2\u7edd\u8bf7\u6c42 Computer \u7ed1\u5b9a Computer \u5c1d\u8bd5\u52a0\u5165\u65b0\u623f\u95f4 \u81ea\u52a8\u79bb\u5f00\u65e7\u623f\u95f4 \u8de8\u623f\u95f4\u8bbf\u95ee \u4e8b\u4ef6\u76ee\u6807\u4e0d\u5728\u540c\u4e00\u623f\u95f4 \u62d2\u7edd\u8def\u7531 \u6743\u9650\u6821\u9a8c \u672a\u52a0\u5165\u623f\u95f4\u5c31\u53d1\u9001\u4e8b\u4ef6 \u62d2\u7edd\u5904\u7406"},{"location":"specification/room-model/#_16","title":"\u8de8\u623f\u95f4\u8bbf\u95ee\u9632\u62a4","text":"<p>Server \u5728\u5904\u7406 <code>client:*</code> \u4e8b\u4ef6\u65f6\u5fc5\u987b\u9a8c\u8bc1\uff1a</p> <pre><code># \u4f2a\u4ee3\u7801\nasync def on_client_tool_call(sid, data):\n    agent_session = get_session(sid)\n    computer_name = data[\"computer\"]\n    computer_sid = get_sid_by_name(computer_name)\n    computer_session = get_session(computer_sid)\n\n    # \u9a8c\u8bc1\u5728\u540c\u4e00\u623f\u95f4\n    if agent_session.office_id != computer_session.office_id:\n        raise PermissionError(\"Cross-room access denied\")\n\n    # \u7ee7\u7eed\u5904\u7406...\n</code></pre>"},{"location":"specification/room-model/#_17","title":"\u6210\u5458\u53d8\u66f4\u901a\u77e5","text":""},{"location":"specification/room-model/#_18","title":"\u52a0\u5165\u901a\u77e5","text":"<p>\u5f53\u6210\u5458\u52a0\u5165\u623f\u95f4\u540e\uff0cServer \u5e7f\u64ad <code>notify:enter_office</code>\uff1a</p> <pre><code>class EnterOfficeNotification(TypedDict, total=False):\n    office_id: str\n    computer: str | None  # \u52a0\u5165\u7684 Computer \u540d\u79f0\n    agent: str | None     # \u52a0\u5165\u7684 Agent \u540d\u79f0\n</code></pre> <p>\u63a5\u6536\u65b9\u5904\u7406\u5efa\u8bae:</p> <ul> <li>Agent \u6536\u5230 Computer \u52a0\u5165\u901a\u77e5\u540e\uff0c\u5e94\u8c03\u7528 <code>client:get_tools</code> \u83b7\u53d6\u5de5\u5177\u5217\u8868</li> <li>Computer \u6536\u5230 Agent \u52a0\u5165\u901a\u77e5\u540e\uff0c\u53ef\u8fdb\u884c\u521d\u59cb\u5316\u51c6\u5907</li> </ul>"},{"location":"specification/room-model/#_19","title":"\u79bb\u5f00\u901a\u77e5","text":"<p>\u5f53\u6210\u5458\u5373\u5c06\u79bb\u5f00\u623f\u95f4\u65f6\uff0cServer \u5e7f\u64ad <code>notify:leave_office</code>\uff1a</p> <pre><code>class LeaveOfficeNotification(TypedDict, total=False):\n    office_id: str\n    computer: str | None  # \u79bb\u5f00\u7684 Computer \u540d\u79f0\n    agent: str | None     # \u79bb\u5f00\u7684 Agent \u540d\u79f0\n</code></pre> <p>\u63a5\u6536\u65b9\u5904\u7406\u5efa\u8bae:</p> <ul> <li>Agent \u6536\u5230 Computer \u79bb\u5f00\u901a\u77e5\u540e\uff0c\u5e94\u6e05\u7406\u8be5 Computer \u7684\u5de5\u5177</li> <li>Computer \u6536\u5230 Agent \u79bb\u5f00\u901a\u77e5\u540e\uff0c\u53ef\u8fdb\u884c\u8d44\u6e90\u6e05\u7406</li> </ul>"},{"location":"specification/room-model/#_20","title":"\u623f\u95f4\u67e5\u8be2","text":"<p>Agent \u53ef\u901a\u8fc7 <code>server:list_room</code> \u4e8b\u4ef6\u67e5\u8be2\u623f\u95f4\u5185\u7684\u6240\u6709\u4f1a\u8bdd\uff1a</p>"},{"location":"specification/room-model/#_21","title":"\u8bf7\u6c42","text":"<pre><code>class ListRoomReq(AgentCallData):\n    agent: str      # Agent \u540d\u79f0\n    req_id: str     # \u8bf7\u6c42 ID\n    office_id: str  # \u623f\u95f4 ID\n</code></pre>"},{"location":"specification/room-model/#_22","title":"\u54cd\u5e94","text":"<pre><code>class SessionInfo(TypedDict, total=False):\n    sid: str\n    name: str\n    role: Literal[\"computer\", \"agent\"]\n    office_id: str\n\nclass ListRoomRet(TypedDict):\n    sessions: list[SessionInfo]\n    req_id: str\n</code></pre>"},{"location":"specification/room-model/#_23","title":"\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"specification/room-model/#id","title":"\u623f\u95f4 ID \u8bbe\u8ba1","text":"<pre><code># \u63a8\u8350\uff1a\u4f7f\u7528 UUID\noffice_id = str(uuid.uuid4())\n\n# \u63a8\u8350\uff1a\u5305\u542b\u4e1a\u52a1\u6807\u8bc6\noffice_id = f\"tenant-{tenant_id}-{uuid.uuid4()}\"\n\n# \u4e0d\u63a8\u8350\uff1a\u4f7f\u7528\u53ef\u9884\u6d4b\u7684\u5e8f\u5217\noffice_id = \"room-1\"  # \u5b89\u5168\u98ce\u9669\n</code></pre>"},{"location":"specification/room-model/#agent_1","title":"Agent \u8fde\u63a5\u7ba1\u7406","text":"<pre><code># \u63a8\u8350\uff1a\u8fde\u63a5\u524d\u68c0\u67e5\u623f\u95f4\u72b6\u6001\nsessions = await agent.get_computers_in_office(office_id)\nif any(s.role == \"agent\" for s in sessions):\n    raise Exception(\"Room already has an agent\")\n\nawait agent.join_office(office_id)\n</code></pre>"},{"location":"specification/room-model/#_24","title":"\u8d44\u6e90\u6e05\u7406","text":"<pre><code># \u63a8\u8350\uff1a\u79bb\u5f00\u623f\u95f4\u65f6\u6e05\u7406\u8d44\u6e90\nasync def cleanup():\n    await agent.leave_office(office_id)\n    # \u6e05\u7406\u672c\u5730\u5de5\u5177\u7f13\u5b58\n    tools_cache.clear()\n</code></pre>"},{"location":"specification/room-model/#_25","title":"\u53c2\u8003","text":"<ul> <li>\u623f\u95f4\u7ba1\u7406\u5b9e\u73b0: <code>a2c_smcp/server/namespace.py</code></li> <li>\u5de5\u5177\u51fd\u6570: <code>a2c_smcp/server/utils.py</code></li> <li>Agent \u623f\u95f4\u64cd\u4f5c: <code>a2c_smcp/agent/client.py</code></li> </ul>"},{"location":"specification/security/","title":"A2C-SMCP \u5b89\u5168\u6027\u8003\u8651","text":"<p>\u672c\u6587\u6863\u63cf\u8ff0\u5b9e\u73b0 A2C-SMCP \u534f\u8bae\u65f6\u7684\u5b89\u5168\u6027\u8981\u6c42\u4e0e\u5efa\u8bae\u3002</p>"},{"location":"specification/security/#_1","title":"\u4f20\u8f93\u5b89\u5168","text":""},{"location":"specification/security/#tls","title":"TLS \u8981\u6c42","text":"\u90e8\u7f72\u73af\u5883 TLS \u8981\u6c42 \u516c\u7f51\u90e8\u7f72 \u5fc5\u987b \u4f7f\u7528 TLS \u5185\u7f51\u90e8\u7f72 \u63a8\u8350 \u4f7f\u7528 TLS \u672c\u5730\u5f00\u53d1 \u53ef\u9009"},{"location":"specification/security/#tls_1","title":"TLS \u914d\u7f6e\u5efa\u8bae","text":"<pre><code># \u63a8\u8350\u7684 TLS \u7248\u672c\nTLS_VERSION = \"TLSv1.2+\"\n\n# \u63a8\u8350\u7684\u5bc6\u7801\u5957\u4ef6\nCIPHER_SUITES = [\n    \"TLS_AES_256_GCM_SHA384\",\n    \"TLS_CHACHA20_POLY1305_SHA256\",\n    \"TLS_AES_128_GCM_SHA256\"\n]\n</code></pre>"},{"location":"specification/security/#mtls-tls","title":"mTLS\uff08\u53cc\u5411 TLS\uff09","text":"<p>\u5bf9\u4e8e\u9700\u8981\u7aef\u5230\u7aef\u4fdd\u5bc6\u7684\u573a\u666f\uff0c\u63a8\u8350\u91c7\u7528 mTLS\uff1a</p> <ul> <li>Client \u548c Server \u90fd\u9700\u8981\u8bc1\u4e66</li> <li>\u63d0\u4f9b\u53cc\u5411\u8eab\u4efd\u9a8c\u8bc1</li> <li>\u9002\u7528\u4e8e\u9ad8\u5b89\u5168\u8981\u6c42\u7684\u4f01\u4e1a\u73af\u5883</li> </ul>"},{"location":"specification/security/#_2","title":"\u8ba4\u8bc1\u4e0e\u6388\u6743","text":""},{"location":"specification/security/#_3","title":"\u8ba4\u8bc1\u673a\u5236","text":"<p>A2C-SMCP \u901a\u8fc7 <code>AuthenticationProvider</code> \u62bd\u8c61\u8ba4\u8bc1\uff1a</p> <pre><code>class AuthenticationProvider(ABC):\n    @abstractmethod\n    async def authenticate(\n        self,\n        server: AsyncServer,\n        environ: dict,\n        auth: dict | None,\n        headers: dict\n    ) -&gt; bool:\n        \"\"\"\u9a8c\u8bc1\u8fde\u63a5\u8bf7\u6c42\"\"\"\n        pass\n</code></pre>"},{"location":"specification/security/#_4","title":"\u8ba4\u8bc1\u7b56\u7565","text":"\u7b56\u7565 \u9002\u7528\u573a\u666f \u5b89\u5168\u7ea7\u522b API Key \u7b80\u5355\u573a\u666f\u3001\u5185\u90e8\u670d\u52a1 \u4e2d JWT Token \u7528\u6237\u8ba4\u8bc1\u3001\u6709\u65f6\u6548\u8981\u6c42 \u9ad8 mTLS \u670d\u52a1\u95f4\u901a\u4fe1\u3001\u9ad8\u5b89\u5168\u8981\u6c42 \u6700\u9ad8"},{"location":"specification/security/#_5","title":"\u9ed8\u8ba4\u8ba4\u8bc1\u5b9e\u73b0","text":"<p>SDK \u63d0\u4f9b\u9ed8\u8ba4\u8ba4\u8bc1\u5b9e\u73b0 <code>DefaultAuthenticationProvider</code>\uff1a</p> <pre><code>auth = DefaultAuthenticationProvider(\n    admin_secret=\"your_admin_secret\",\n    api_key_name=\"x-api-key\"\n)\n</code></pre> <p>\u6ce8\u610f: \u9ed8\u8ba4\u5b9e\u73b0\u4ec5\u9002\u7528\u4e8e\u5f00\u53d1\u548c\u6d4b\u8bd5\uff0c\u751f\u4ea7\u73af\u5883\u5e94\u5b9e\u73b0\u81ea\u5b9a\u4e49\u8ba4\u8bc1\u3002</p>"},{"location":"specification/security/#_6","title":"\u51ed\u8bc1\u7ba1\u7406","text":""},{"location":"specification/security/#_7","title":"\u96f6\u51ed\u8bc1\u4f20\u64ad\u539f\u5219","text":"<p>A2C-SMCP \u7684\u6838\u5fc3\u5b89\u5168\u539f\u5219\u662f\u96f6\u51ed\u8bc1\u4f20\u64ad\uff1a</p> <pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Agent                          \u2502\n\u2502                                                   \u2502\n\u2502  \u2717 \u4e0d\u6301\u6709\u654f\u611f\u51ed\u8bc1                                 \u2502\n\u2502  \u2717 \u4e0d\u63a5\u89e6 MCP Server Token                       \u2502\n\u2502  \u2717 \u4e0d\u8bbf\u95ee\u672c\u5730\u8d44\u6e90                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                        \u2502\n                        \u2502 SMCP \u534f\u8bae\n                        \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Computer                        \u2502\n\u2502                                                   \u2502\n\u2502  \u2713 \u6301\u6709 MCP Server \u51ed\u8bc1                          \u2502\n\u2502  \u2713 \u7ba1\u7406\u672c\u5730\u8d44\u6e90\u8bbf\u95ee                              \u2502\n\u2502  \u2713 \u51ed\u8bc1\u4e0d\u5916\u4f20                                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"specification/security/#_8","title":"\u51ed\u8bc1\u5b58\u50a8\u5efa\u8bae","text":"\u51ed\u8bc1\u7c7b\u578b \u5b58\u50a8\u4f4d\u7f6e \u52a0\u5bc6\u8981\u6c42 API Key \u73af\u5883\u53d8\u91cf / \u5bc6\u94a5\u7ba1\u7406\u670d\u52a1 \u63a8\u8350 \u6570\u636e\u5e93\u5bc6\u7801 \u5bc6\u94a5\u7ba1\u7406\u670d\u52a1 \u5fc5\u987b \u8bc1\u4e66\u79c1\u94a5 \u6587\u4ef6\u7cfb\u7edf\uff08\u53d7\u4fdd\u62a4\uff09 \u63a8\u8350"},{"location":"specification/security/#_9","title":"\u73af\u5883\u53d8\u91cf\u5b89\u5168","text":"<pre><code># \u63a8\u8350\uff1a\u4f7f\u7528\u73af\u5883\u53d8\u91cf\nexport API_KEY=\"your_api_key\"\n\n# \u4e0d\u63a8\u8350\uff1a\u786c\u7f16\u7801\napi_key = \"your_api_key\"  # \u5371\u9669\uff01\n</code></pre>"},{"location":"specification/security/#_10","title":"\u623f\u95f4\u9694\u79bb","text":""},{"location":"specification/security/#_11","title":"\u9694\u79bb\u8981\u6c42","text":"<p>Server \u5fc5\u987b\u5b9e\u73b0\u4ee5\u4e0b\u9694\u79bb\u4fdd\u969c\uff1a</p> <ol> <li>\u8de8\u623f\u95f4\u8bbf\u95ee\u7981\u6b62: \u4e8b\u4ef6\u4e0d\u80fd\u8def\u7531\u5230\u5176\u4ed6\u623f\u95f4</li> <li>Agent \u72ec\u5360\u6027: \u4e00\u4e2a\u623f\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a Agent</li> <li>\u6d88\u606f\u9694\u79bb: \u901a\u77e5\u53ea\u5e7f\u64ad\u7ed9\u540c\u4e00\u623f\u95f4\u6210\u5458</li> </ol>"},{"location":"specification/security/#_12","title":"\u5b9e\u73b0\u68c0\u67e5\u6e05\u5355","text":"<pre><code># Server \u5fc5\u987b\u9a8c\u8bc1\ndef validate_room_access(sid, target_office_id):\n    session = get_session(sid)\n    if session.office_id != target_office_id:\n        raise PermissionError(\"Cross-room access denied\")\n</code></pre>"},{"location":"specification/security/#_13","title":"\u8f93\u5165\u9a8c\u8bc1","text":""},{"location":"specification/security/#_14","title":"\u6570\u636e\u9a8c\u8bc1\u8981\u6c42","text":"<p>\u6240\u6709\u8f93\u5165\u6570\u636e\u5fc5\u987b\u8fdb\u884c\u9a8c\u8bc1\uff1a</p> \u9a8c\u8bc1\u9879 \u8bf4\u660e \u7c7b\u578b\u68c0\u67e5 \u786e\u4fdd\u5b57\u6bb5\u7c7b\u578b\u6b63\u786e \u957f\u5ea6\u9650\u5236 \u9632\u6b62\u7f13\u51b2\u533a\u6ea2\u51fa \u683c\u5f0f\u6821\u9a8c \u9a8c\u8bc1 URL\u3001ID \u7b49\u683c\u5f0f \u8303\u56f4\u68c0\u67e5 \u9a8c\u8bc1\u6570\u503c\u5728\u5408\u7406\u8303\u56f4\u5185"},{"location":"specification/security/#_15","title":"\u5de5\u5177\u53c2\u6570\u9a8c\u8bc1","text":"<pre><code># \u63a8\u8350\uff1a\u4f7f\u7528 Pydantic \u8fdb\u884c\u9a8c\u8bc1\nfrom pydantic import BaseModel, validator\n\nclass ToolCallParams(BaseModel):\n    tool_name: str\n    params: dict\n    timeout: int\n\n    @validator('timeout')\n    def validate_timeout(cls, v):\n        if v &lt;= 0 or v &gt; 3600:\n            raise ValueError('Timeout must be between 1 and 3600')\n        return v\n</code></pre>"},{"location":"specification/security/#_16","title":"\u8d44\u6e90\u9650\u5236","text":""},{"location":"specification/security/#dos","title":"DoS \u9632\u62a4","text":"<p>\u5b9e\u73b0\u5e94\u8be5\u5bf9\u4ee5\u4e0b\u8d44\u6e90\u8bbe\u7f6e\u9650\u5236\uff1a</p> \u8d44\u6e90 \u5efa\u8bae\u9650\u5236 \u5e76\u53d1\u8fde\u63a5\u6570 \u6bcf IP 100 \u4e2a \u8bf7\u6c42\u9891\u7387 \u6bcf\u79d2 100 \u8bf7\u6c42 \u6d88\u606f\u5927\u5c0f 1MB \u5de5\u5177\u8c03\u7528\u8d85\u65f6 300 \u79d2"},{"location":"specification/security/#_17","title":"\u9650\u6d41\u5b9e\u73b0","text":"<pre><code># \u793a\u4f8b\uff1a\u4f7f\u7528\u4ee4\u724c\u6876\u7b97\u6cd5\nfrom ratelimit import limits, sleep_and_retry\n\n@sleep_and_retry\n@limits(calls=100, period=1)\ndef handle_request(request):\n    # \u5904\u7406\u8bf7\u6c42\n    pass\n</code></pre>"},{"location":"specification/security/#_18","title":"\u65e5\u5fd7\u4e0e\u5ba1\u8ba1","text":""},{"location":"specification/security/#_19","title":"\u5b89\u5168\u65e5\u5fd7","text":"<p>\u5e94\u8be5\u8bb0\u5f55\u4ee5\u4e0b\u5b89\u5168\u76f8\u5173\u4e8b\u4ef6\uff1a</p> \u4e8b\u4ef6\u7c7b\u578b \u65e5\u5fd7\u7ea7\u522b \u8ba4\u8bc1\u5931\u8d25 WARNING \u8de8\u623f\u95f4\u8bbf\u95ee\u5c1d\u8bd5 WARNING \u6743\u9650\u62d2\u7edd WARNING \u5f02\u5e38\u9ad8\u9891\u8bf7\u6c42 WARNING \u654f\u611f\u64cd\u4f5c INFO"},{"location":"specification/security/#_20","title":"\u65e5\u5fd7\u683c\u5f0f","text":"<pre><code># \u63a8\u8350\u7684\u5b89\u5168\u65e5\u5fd7\u683c\u5f0f\nlogger.warning(\n    \"Authentication failed\",\n    extra={\n        \"client_ip\": client_ip,\n        \"user_agent\": user_agent,\n        \"reason\": \"Invalid API key\",\n        \"timestamp\": datetime.utcnow().isoformat()\n    }\n)\n</code></pre>"},{"location":"specification/security/#_21","title":"\u654f\u611f\u4fe1\u606f\u8fc7\u6ee4","text":"<p>\u65e5\u5fd7\u7981\u6b62\u5305\u542b\uff1a</p> <ul> <li>API \u5bc6\u94a5\u6216 Token</li> <li>\u5bc6\u7801</li> <li>\u4e2a\u4eba\u8eab\u4efd\u4fe1\u606f\uff08PII\uff09</li> <li>\u4fe1\u7528\u5361\u53f7\u7b49\u91d1\u878d\u4fe1\u606f</li> </ul>"},{"location":"specification/security/#_22","title":"\u5b89\u5168\u66f4\u65b0","text":""},{"location":"specification/security/#_23","title":"\u4f9d\u8d56\u7ba1\u7406","text":"<ul> <li>\u5b9a\u671f\u66f4\u65b0\u4f9d\u8d56\u5305</li> <li>\u4f7f\u7528 <code>pip-audit</code> \u6216 <code>safety</code> \u68c0\u67e5\u6f0f\u6d1e</li> <li>\u8ba2\u9605\u5b89\u5168\u516c\u544a</li> </ul>"},{"location":"specification/security/#_24","title":"\u6f0f\u6d1e\u54cd\u5e94","text":"<ol> <li>\u8bc4\u4f30\u6f0f\u6d1e\u5f71\u54cd</li> <li>\u5236\u5b9a\u4fee\u590d\u8ba1\u5212</li> <li>\u53d1\u5e03\u5b89\u5168\u8865\u4e01</li> <li>\u901a\u77e5\u7528\u6237\u66f4\u65b0</li> </ol>"},{"location":"specification/security/#_25","title":"\u5b89\u5168\u68c0\u67e5\u6e05\u5355","text":""},{"location":"specification/security/#_26","title":"\u90e8\u7f72\u524d\u68c0\u67e5","text":"<ul> <li> TLS \u5df2\u542f\u7528\uff08\u516c\u7f51\u90e8\u7f72\uff09</li> <li> \u8ba4\u8bc1\u673a\u5236\u5df2\u914d\u7f6e</li> <li> \u654f\u611f\u51ed\u8bc1\u672a\u786c\u7f16\u7801</li> <li> \u8f93\u5165\u9a8c\u8bc1\u5df2\u5b9e\u73b0</li> <li> \u8d44\u6e90\u9650\u5236\u5df2\u914d\u7f6e</li> <li> \u5b89\u5168\u65e5\u5fd7\u5df2\u542f\u7528</li> <li> \u4f9d\u8d56\u65e0\u5df2\u77e5\u6f0f\u6d1e</li> </ul>"},{"location":"specification/security/#_27","title":"\u5b9a\u671f\u68c0\u67e5","text":"<ul> <li> \u8bc1\u4e66\u6709\u6548\u6027</li> <li> API \u5bc6\u94a5\u8f6e\u6362</li> <li> \u65e5\u5fd7\u5ba1\u8ba1</li> <li> \u4f9d\u8d56\u66f4\u65b0</li> <li> \u6e17\u900f\u6d4b\u8bd5</li> </ul>"},{"location":"specification/security/#_28","title":"\u53c2\u8003","text":"<ul> <li>OWASP Top 10: https://owasp.org/www-project-top-ten/</li> <li>Socket.IO \u5b89\u5168: https://socket.io/docs/v4/security/</li> <li>Python \u5b89\u5168: https://python-security.readthedocs.io/</li> </ul>"}]}